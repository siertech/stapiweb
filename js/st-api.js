"use strict";!function(){var app,stApi;try{stApi=angular.module("stapi",["ngMdIcons","dndLists","ngMaterial","md.data.table","ngMessages","angularSpinner","ngRoute","ngCookies","angular.filter","ngStorage","angular-confirm","chart.js","ngAnimate","ngSanitize","ui.utils.masks"]),app=angular.module("stapiApp",["socialLogin","angular-json-tree","stapi","ngSimditor","ui.codemirror","youtube-embed","ng.deviceDetector","ngOnboarding","angularResizable","oc.lazyLoad"])}catch(e){window.alert(e)}app.config(function($locationProvider){}),app.config(["$ocLazyLoadProvider",function($ocLazyLoadProvider){$ocLazyLoadProvider.config({debug:!0})}]),app.config(function($provide){$provide.decorator("simditorOptions",["$delegate",function(simditorOptions){return Simditor.locale="pt-BR",simditorOptions.toolbar=["title","bold","italic","underline","strikethrough","color","ol","ul","blockquote","code","table","link","image","hr","indent","outdent","alignment"],simditorOptions.toolbarFloat=!0,simditorOptions.toolbarFloatOffset=0,simditorOptions.toolbarHidden=!1,simditorOptions}])}),app.run(["$rootScope","$route","$localStorage","$location","st","$filter","config","$templateCache","$mdDateLocale","stUtil","$mdDialog",function($rootScope,$route,$localStorage,$location,st,$filter,config,$templateCache,$mdDateLocale,stUtil,$mdDialog){angular.module=function(){return app},$rootScope.$on("event:social-sign-in-success",function(event,userDetails){var msg="<div layout='row' layout-align='center'><md-card flex><md-card-content><p>Login efetuado com sucesso!\n Usuário: "+userDetails.name+"</p><p><strong>E-mail</strong>: "+userDetails.email+"</p><p><span  ><img style='border-radius: 50%'  src=' "+userDetails.imageUrl+"' /></span></p><p><strong>UID</strong>: "+userDetails.uid+"</p><p><strong>Provider</strong>: "+userDetails.provider+"</p><p><strong>Token</strong>: "+userDetails.token+"</p><p><strong>ID Token</strong>: "+userDetails.idToken+"</p></md-card-content></md-card></div>";$mdDialog.show($mdDialog.alert().clickOutsideToClose(!0).title("Login social").htmlContent(msg).ariaLabel("Login social").ok("OK"))})}]),stApi.run(["$rootScope","$route","$localStorage","$location","st","$filter","config","$templateCache","$mdDateLocale","loginUtil",function($rootScope,$route,$localStorage,$location,st,$filter,config,$templateCache,$mdDateLocale,loginUtil){try{$mdDateLocale.formatDate=function(date){return $filter("date")(date,"dd/MM/yyyy")},$templateCache.put("arrow-up2.svg",'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"/></svg>'),document.documentElement.addEventListener("gesturestart",function(event){event.preventDefault()},!1);var tempoCarregamento=((new Date).getTime()-window.inicioCarregamento)/1e3;st.evt({evento:"tempo_carregamento_sistema",descricao:tempoCarregamento}),$rootScope.$on("$routeChangeStart",function(event,next,current){if("/"==next.$$route.originalPath)return void $location.path("/login");if(!($rootScope.usuarioSistema||next.$$route&&-1!=next.$$route.originalPath.indexOf("/login/:login")||-1!=next.$$route.originalPath.indexOf("/cadastro/:login")||-1!=next.$$route.originalPath.indexOf("/prot/:template"))){console.log("secutity path"),console.log(config.confs.securityPaths),console.log("original path: "),console.log(next.$$route.originalPath);var originalPath=next.$$route.originalPath.replace("/","");if(!config.confs.securityPaths||"all"==config.confs.securityPaths||-1!=config.confs.securityPaths.indexOf(originalPath)){var login={empresa:$localStorage.empresa,usuario:$localStorage.usuario,senha:$localStorage.senha},path=next.$$route.originalPath;loginUtil.logar(login,!0,function(loginData){loginData?$route.reload():(path!=config.loginPath&&"/login"!=path&&($rootScope.pathPosLogin=path),$location.path(config.loginPath||"login"))})}}})}catch(e){window.alert("O Sistema não é compatível com seu navegador!\n"+e),console.log(e)}}]),stApi.config(function($routeProvider,$httpProvider){$httpProvider.interceptors.push(function($q,$rootScope,$location,$localStorage,usSpinnerService){return{responseError:function(rejection){var status=rejection.status,responseConfig=rejection.config;responseConfig=responseConfig||{};responseConfig.method,responseConfig.url;return usSpinnerService.stop("spinner-1"),401==status&&(delete $localStorage.senha,$location.path(config.confs.loginPath||"/login")),$q.reject(rejection)}}}),$httpProvider.interceptors.push(function($q,$rootScope,$location,$cookieStore,usSpinnerService,cacheGet){return{request:function(requestConfig){if(-1==requestConfig.url.indexOf("projecao/execute-query")&&-1==requestConfig.url.indexOf("projecao/get-projecoes")&&-1==requestConfig.url.indexOf("isCachePost=true")&&usSpinnerService.spin("spinner-1"),-1==requestConfig.url.indexOf(".html")&&-1==requestConfig.url.indexOf(".svg")){var authToken=$rootScope.authToken||$cookieStore.get("authToken"),filialId=0,operadorId=0;$rootScope.currentFilial&&(filialId=$rootScope.currentFilial.id),$rootScope.currentOperador&&(operadorId=$rootScope.currentOperador.id);var operator="?";-1!=requestConfig.url.indexOf("?")&&(operator="&&"),requestConfig.url=requestConfig.url+operator+"token="+authToken,-1==requestConfig.url.indexOf("filialId")&&(requestConfig.url=requestConfig.url+"&&filialId="+filialId),-1==requestConfig.url.indexOf("operadorId")&&(requestConfig.url=requestConfig.url+"&&operadorId="+operadorId)}return requestConfig||$q.when(requestConfig)},response:function(res){return usSpinnerService.stop("spinner-1"),res||$q.when(res)}}})}),app.config(function(socialProvider){socialProvider.setGoogleKey("378761299013-tmcfh7l67glgelmam1e8ju96tndn813n.apps.googleusercontent.com")}),stApi.config(function($routeProvider,$httpProvider){$routeProvider.when("/",{})}),stApi.config(["$locationProvider",function($locationProvider){$locationProvider.hashPrefix("")}]),stApi.config(function($compileProvider,ChartJsProvider){$compileProvider.preAssignBindingsEnabled(!0)})}(),function(){function prototipoDetalheCtrl($scope,$controller,itemId,stUtil,stService,$route,$location,$compile){function changeHtmlCompiled(){ctrl.versaoPrototipo.cssContent=ctrl.versaoPrototipo.cssContent||"";var css="<style type='text/css'>\n"+ctrl.versaoPrototipo.cssContent+"\n</style>\n",html=css+ctrl.versaoPrototipo.codigo,element=$("#htmlContent");element.html($compile(html)($scope))}function getList(){stService.getList(options).then(function(data){ctrl.versoesPrototipo=data.itens,ctrl.versaoPrototipo=ctrl.versaoPrototipo||data.itens[0]||{},ctrl.versaoPrototipo.label=ctrl.versaoPrototipo.label||"V1.0"})}var ctrl=this;$scope.$watch("$prototipoDetalheCtrl.activeTab",function(value){1==value&&changeHtmlCompiled()}),$scope.$watch("$prototipoDetalheCtrl.versaoPrototipo",function(){1==ctrl.activeTab&&changeHtmlCompiled()});var options={objectName:"VersaoPrototipo",querys:["prototipo.id="+itemId]};getList(),ctrl.deletarPrototipo=function(versaoPrototipo){stService["delete"]("Prototipo",[versaoPrototipo.prototipo.id]).then(function(data){$location.path("prototipo")})},ctrl.deletarVersao=function(versaoPrototipo){stService["delete"]("VersaoPrototipo",[versaoPrototipo.id]).then(function(data){$route.reload()})},ctrl.salvar=function(versaoPrototipo){stService.save("VersaoPrototipo",versaoPrototipo).then(function(data){ctrl.versaoPrototipo=data.item,stUtil.showMessage("","Salvo com sucesso"),getList()})},ctrl.salvarComoNovaVersao=function(versaoPrototipo){var copyOb=angular.copy(versaoPrototipo);copyOb.id=0,stService.save("VersaoPrototipo",copyOb).then(function(data){ctrl.versaoPrototipo=data.item,stUtil.showMessage("","Salvo com sucesso"),getList()})}}function prototipoListCtrl($scope,$controller,config,stCrudTools,stUtil,$route,$location){function saveSuccessResolve(obj){stUtil.showMessage("","Salvo com sucesso!"),obj.$mdDialog.hide(),$route.reload()}function cancelResolve(){}var ctrl=this;angular.extend(ctrl,$controller("genericListController",{$scope:$scope,objectName:objectName,detalheTemplateUrl:"global/st-api/prototipo/html/prototipoDetalhe.html",detalheController:"prototipoDetalheCtrl",detalheControllerAs:"$prototipoDetalheCtrl",filtros:[{attr:"titulo",label:"Título do protótipo"}]})),ctrl.data.tableColumns=[{label:"Título do protótipo",attr:"titulo",orderBy:!0,labelIcon:"code"}],ctrl.data.openDetail=function(item){item=item||{};var id=item.id||0;$location.path("prototipo/"+id)},ctrl.data.orderBy="titulo",ctrl.data.requestListParams={objectName:objectName,maxItensPerPage:config.confs.maxItemsPerPage||9},ctrl.data.saveSuccesResolve=saveSuccessResolve,ctrl.data.cancelResolve=cancelResolve,ctrl.data.getList()}angular.module("stapi").controller("prototipoDetalheCtrl",prototipoDetalheCtrl).controller("prototipoListCtrl",prototipoListCtrl);var objectName="Prototipo"}(),function(){function prototipoList(){return{restrict:"E",templateUrl:"global/st-api/prototipo/html/prototipoList.html",controller:"prototipoListCtrl",controllerAs:"$prototipoListCtrl"}}function prototipoGridView(){return{restrict:"E",templateUrl:"global/st-api/prototipo/html/prototipoGridView.html"}}function prototipoTableView(){return{restrict:"E",templateUrl:"global/st-api/prototipo/html/prototipoTableView.html"}}function prototipoForm(){return{restrict:"E",templateUrl:"global/st-api/prototipo/html/prototipoForm.html"}}angular.module("stapi").directive("prototipoGridView",prototipoGridView).directive("prototipoTableView",prototipoTableView).directive("prototipoList",prototipoList).directive("prototipoDetalhe",prototipoList).directive("prototipoForm",prototipoForm)}(),function(){function prototipoUtil($mdDialogstService,$q,$mdDialog,$mdMedia,stCrudToolsUtils){}angular.module("stapi").factory("prototipoUtil",prototipoUtil)}(),function(){angular.module("stapi").config(function($routeProvider,$httpProvider){$routeProvider.when("/prototipo",{template:"<prototipo-list></prototipo-list>"}),$routeProvider.when("/prototipo/:id",{templateUrl:"global/st-api/prototipo/html/prototipoDetalhe.html",controller:"prototipoDetalheCtrl",controllerAs:"$prototipoDetalheCtrl",resolve:{itemId:function($route){return $route.current.params.id}}})})}(),function(){angular.module("stapi").controller("stChartContentCtrl",function($scope){var ctrl=this;ctrl.charts=[]}),angular.module("stapi").controller("stChartItemCtrl",function($scope){}),angular.module("stapi").controller("stChartCtrl",function($scope,$mdColors,$mdColorUtil,stChartUtil,$filter){function getDados(maxItens){$scope.loading=!0;var querys=$scope.querys||[];"string"==typeof querys&&(querys=querys.split(","));var basicInfo={qs:querys||[],columns:$scope.labelColumn+","+$scope.valueColumn+" ",objeto:$scope.objectName,groupBy:$scope.labelColumn,extra:"order by "+($scope.orderBy||$scope.valueColumn)+" "+$scope.order,max:$scope.max},dadosExemplo=$scope.dadosExemplo;delete $scope.proj,stChartUtil.chartFactory($scope,basicInfo,$scope.periodColumn,function(proj){0==proj.labels.length&&(proj=dadosExemplo,proj&&(proj.dadosExemplo=!0));var filter=$scope.labelFilter||"";if(filter=filter.split(":"),filter[0].length>0&&proj)for(var i in proj.labels)proj.labels[i]=$filter(filter[0])(proj.labels[i],filter[1]);$scope.chartOptions={};var colors=[$mdColorUtil.rgbaToHex($mdColors.getThemeColor("blue")),$mdColorUtil.rgbaToHex($mdColors.getThemeColor("grey")),$mdColorUtil.rgbaToHex($mdColors.getThemeColor("red")),$mdColorUtil.rgbaToHex($mdColors.getThemeColor("green")),$mdColorUtil.rgbaToHex($mdColors.getThemeColor("yellow"))];proj&&(proj.colors=colors),$scope.proj=proj,$scope.loading=!1})}$scope.de=$scope.de||"1900-10-05",$scope.ate=$scope.ate||"3000-10-05",$scope.maxItens=$scope.maxItens||stChartUtil.MAX_ITENS_DEFAULT,$scope.order=stChartUtil.ORDER_DEFAULT,delete $scope.projs,getDados(),$scope.getDados=getDados})}(),function(){angular.module("stapi").directive("stChartContent",function(){return{restrict:"E",transclude:!0,template:"<div ng-transclude></div>",scope:{de:"<",ate:"<"},controller:"stChartContentCtrl",bindToController:!0,controllerAs:"ctrl"}}).directive("stChartItem",function(stChartUtil){return{restrict:"E",bindToController:!0,controllerAs:"ctrl",templateUrl:"global/st-api/st-chart/html/chart.html",require:"^stChartContent",scope:{objectName:"@",querys:"<",valueColumn:"@",orderBy:"@",labelColumn:"@",periodColumn:"@",max:"@",de:"<",ate:"<",labelFilter:"@"},link:function(scope,element,attrs,ctrl){console.log("controller aqui: "),console.log(ctrl)},controller:"stChartItemCtrl"}}).directive("stChart",function(stChartUtil){return{restrict:"E",templateUrl:"global/st-api/st-chart/html/chart.html",scope:{objectName:"@",querys:"<",valueColumn:"@",orderBy:"@",labelColumn:"@",periodColumn:"@",max:"@",de:"<",ate:"<",labelFilter:"@"},link:function(scope,element,attrs,ctrl){console.log("controller aqui: "),console.log(ctrl)},controller:"stChartCtrl"}}).directive("componentVendasTabela",function(stService,stUtil,dateUtil){return{restrict:"E",templateUrl:"global/st-app/app-relatorio/template-module/component-vendas-tabela.html",scope:{de:"=",ate:"="},controller:function($scope){function getDados(nomeProduto,quantItens){$scope.carregandoDados=!0;var qs=["disable=0","quantidade>0"];qs.push(dateUtil.getQueryOfPeriod("date",$scope.de||new Date,$scope.ate||new Date)),nomeProduto&&nomeProduto.length>0&&qs.push("produto.nome like '%"+nomeProduto+"%'"),qs.push("tipoEntrada=0");var ops={qs:qs,columns:"produto.nome,sum(quantidade),min(valorUnitario),max(valorUnitario),avg(valorUnitario)",objeto:"Pedido",groupBy:"produto.id",extra:"order by sum(quantidade) DESC",max:quantItens||30};stService.getProjecoes(ops).success(function(data){$scope.carregandoDados=!1,$scope.projs=data.itens}).error(function(){$scope.carregandoDados=!1})}$scope.chartOptions={tooltipTemplate:"<%=label + ': R$ '  +  Chart.moneyFormat(value) %>",type:"pie"},$scope.$on("changePeriod",getDados),$scope.quantItens="30",getDados(),$scope.getDados=getDados}}}).directive("componentLucroPeriodo",function(relatorioUtil,stUtil,stService,dateUtil,$filter){return{restrict:"E",templateUrl:"global/st-app/app-relatorio/template-module/chart-bar.html",scope:{de:"=",ate:"=",colours:"="},controller:function($scope){function projsToArray(projs){var array=[];for(var i in projs)array.push({data:dateUtil.getDate(projs[i][0]),valor:projs[i][1]});return array}function getProjByMonth(mes,ano,projs){for(var i in projs)if(projs[i].data.getMonth()==mes&&projs[i].data.getFullYear()==ano)return projs[i];return null}function getProjsBalanco(dataIni,dataFim,projReceitas,projDespesas){dataIni=dateUtil.getDate(dataIni),dataFim=dateUtil.getDate(dataFim),projReceitas=projsToArray(projReceitas),projDespesas=projsToArray(projDespesas);var proj={},data=[],labels=[],soma=0;for(dataIni;dataFim>=dataIni;dataIni=dateUtil.incrementaData(dataIni)){var obReceitas=getProjByMonth(dataIni.getMonth(),dataIni.getFullYear(),projReceitas)||{valor:0},obDespesas=getProjByMonth(dataIni.getMonth(),dataIni.getFullYear(),projDespesas)||{valor:0},balanco=obReceitas.valor-obDespesas.valor;soma+=balanco,data.push(balanco),labels.push($filter("date")(dataIni,"MMMM/yyyy"))}return proj.media=soma/data.length,proj.data=[data],proj.labels=labels,proj.colours=[{fillColor:"#3276b1",strokeColor:"#3276b1",highlightFill:"#3276b1",highlightStroke:"#3276b1"}],proj}function getDados(){$scope.chartOptions={tooltipTemplate:"<%=label + ': R$ '  +  Chart.moneyFormat(value) %>"};var basicQuerys=["disable=0","baixada=1","valor>0"],basicInfo={columns:"dataBaixa,sum(valor)",objeto:"Movimentacao",groupBy:"month(dataBaixa)",extra:" order by dataBaixa asc"};basicQuerys.push(dateUtil.getQueryOfPeriod("dataBaixa",$scope.de||new Date,$scope.ate||new Date)),basicInfo.qs=angular.copy(basicQuerys),basicInfo.qs.push("tipo=2"),stService.getProjecoes(basicInfo).success(function(respReceitas){var projReceitas=respReceitas.itens;basicInfo.qs=angular.copy(basicQuerys),basicInfo.qs.push("tipo=1"),stService.getProjecoes(basicInfo).success(function(respDespesas){var projDespesas=respDespesas.itens,proj=getProjsBalanco($scope.de,$scope.ate,projReceitas,projDespesas);console.log("Projecoes"),console.log(proj),$scope.proj=proj})})}getDados(),$scope.$on("changePeriod",getDados)}}}).directive("componentBalanco",function(stService,$filter,dateUtil,movUtil){return{restrict:"E",templateUrl:"global/st-app/app-relatorio/template-module/component-balanco.html",scope:{de:"=",ate:"="},controller:function($scope,movUtil){function getBalanco(){$scope.loading=!0,movUtil.getBalanco($scope.de,$scope.ate,function(receitasRealizadas,despesasRealizadas,receitasPrevistas,despesasPrevistas){$scope.loading=!1,$scope.receitasRealizadas=receitasRealizadas,$scope.despesasRealizadas=despesasRealizadas,$scope.receitasPrevistas=receitasPrevistas,$scope.despesasPrevistas=despesasPrevistas,$scope.lucroPrevisto=receitasPrevistas-despesasPrevistas,$scope.lucroRealizado=receitasRealizadas-despesasRealizadas,$scope.faltaPagar=$scope.despesasPrevistas-$scope.despesasRealizadas,$scope.faltaReceber=$scope.receitasPrevistas-$scope.receitasRealizadas,$scope.faltaPagar<0&&($scope.faltaPagar=0),$scope.faltaReceber<0&&($scope.faltaReceber=0)})}$scope.$on("changePeriod",getBalanco),$scope.de=$scope.de||"1900-10-05",$scope.ate=$scope.ate||"3000-10-05",getBalanco()}}}).directive("componentAnterioresBaixadas",function(stService,$filter,dateUtil,stUtil,movUtil){return{restrict:"E",templateUrl:"global/st-app/app-relatorio/template-module/component-anteriores-baixadas.html",scope:{de:"=",ate:"="},controller:function($scope){function getMovs(){var querys=[];querys.push("tipo=2"),querys.push("data <'"+stUtil.formatData($scope.de||new Date)+"'"),querys.push(dateUtil.getQueryOfPeriod("dataBaixa",$scope.de||new Date,$scope.ate||new Date));var ops={qs:querys,columns:"valor",groupBy:"id",objeto:"Movimentacao"};ops.extra="tipo=2",stService.executeGet("/movimentacao/busca/map",{qs:querys,pagina:0,max:0,extra:""}).success(function(data){var total=0,itens=data.itens;if(data.itens.length>0){$scope.lancamentosAnteriores=data.itens;for(var i in itens)total+=itens[i].valor;$scope.totalLancamentosAnteriores=total}else $scope.lancamentosAnteriores=null,$scope.totalLancamentosAnteriores=0})}$scope.$on("changePeriod",getMovs),getMovs()}}})}(),function(){angular.module("stapi").factory("stChartUtil",function(dateUtil,stService,$rootScope){var _MAX_ITENS_DEFAULT="0",_ORDER_DEFAULT="ASC",_chartFactory=function(scope,basicInfo,periodColumn,callback){function getDados(){_getChartObject(basicInfo,periodColumn,scope.de,scope.ate,function(proj){callback(proj)})}scope.$on("changePeriod",getDados),getDados()},_getChartObject=function(dados,periodColumn,dataDe,dataAte,callback){var info=angular.copy(dados);info.qs=info.qs||[],dataDe&&null!=dataDe&&dataAte&&null!=dataAte&&info.qs.push(dateUtil.getQueryOfPeriod(periodColumn,dataDe,dataAte)),stService.getProjecoes(info).then(function(data){var itens=data.itens,labelsGrafico=[],dataGrafico=[];for(var i in itens)labelsGrafico.push(itens[i][0]||"Outros"),dataGrafico.push(itens[i][1]);var proj={};proj.labels=labelsGrafico,proj.data=dataGrafico,proj.labels.length>4&&(proj.data=[proj.data]),callback(proj)})},_maxItensDefault=function(){return"5"};return{getChartObject:_getChartObject,chartFactory:_chartFactory,maxItensDefault:_maxItensDefault,MAX_ITENS_DEFAULT:_MAX_ITENS_DEFAULT,ORDER_DEFAULT:_ORDER_DEFAULT}})}(),function(){function stDetalheController($scope,objectName,item,controllerAs,functionToNotify,stCrudToolsUtils,$mdDialog){function cancelFunction(ctrl){$mdDialog.cancel()}function saveFunction(item){console.log("item a ser salvo: "),console.log(item),ctrl.savingItem=!0,stCrudToolsUtils.saveAndNotify(objectName,item,$mdDialog,functionToNotify).then(function(obj){ctrl.savingItem=!1})["catch"](function(){ctrl.salvandoItem=!1})}function deleteFunction(item){ctrl.deletingItem=!0,stCrudToolsUtils.deleteAndNotify(objectName,item,$mdDialog,functionToNotify).then(function(obj){$mdDialog.hide(),ctrl.deletingItem=!1})["catch"](function(){ctrl.deletingItem=!1})}function init(){ctrl.item=item||{},ctrl.salvandoItem=!1}var ctrl=this;$scope.controllerAs=controllerAs,ctrl.tarefas=[{titulo:"Titulo da tarefa",ok:"true"}],ctrl.cancelFunction=cancelFunction,ctrl.deleteFunction=deleteFunction,ctrl.saveFunction=saveFunction,init()}angular.module("stapi").controller("stDetalheCtrl",stDetalheController)}(),function(){function stCrudTools(){return{restrict:"E",scope:{item:"<",openDetail:"&",deleteFunction:"&",icon:"@"},templateUrl:"global/st-api/st-crud-tools/html/crudTools.html",bindToController:!0,controllerAs:"$stCrudToolsCtrl",controller:function(){var ctrl=this;ctrl.openMenu=function($mdMenu,event){event.stopPropagation(),$mdMenu.open()}}}}angular.module("stapi").directive("crudTools",stCrudTools).directive("stCrudTools",stCrudTools)}(),function(){function stCrudToolsUtils(stService,$q,$mdMedia,$mdDialog){var CANCEL="CANCEL",SAVE_SUCCESS="SAVE_SUCCESS",SAVE_ERROR="SAVE_ERROR",DELETE_SUCCESS="DELETE_SUCCESS",DELETE_ERROR="DELETE_ERROR",_cancelAndNotify=function(functionToNotify){var objNotify={};objNotify.event=CANCEL,functionToNotify(objNotify)},_saveAndNotify=function(options){var deferred=$q.defer(),objNotify={};return objNotify.$mdDialog=$mdDialog,objNotify.itemAnt=angular.copy(options.item),stService.save(options.objectName,options.item).then(function(response){objNotify.response=response,objNotify.item=response.item,objNotify.event=SAVE_SUCCESS,options.functionToNotify(objNotify),deferred.resolve(response)},function(response){objNotify.event=SAVE_ERROR,objNotify.response=response,options.functionToNotify(objNotify),deferred.reject(response)}),deferred.promise},_deleteAndNotify=function(options){var deferred=$q.defer(),objNotify={};return objNotify.$mdDialog=options.$mdDialog,objNotify.item=options.item,stService["delete"](options.objectName,[options.item.id]).then(function(response){objNotify.response=response,objNotify.event=DELETE_SUCCESS,options.functionToNotify(objNotify),deferred.resolve(response)},function(response){objNotify.event=DELETE_ERROR,objNotify.response=response,options.functionToNotify(objNotify),deferred.reject(response)}),deferred.promise};return{saveAndNotify:_saveAndNotify,deleteAndNotify:_deleteAndNotify,cancelAndNotify:_cancelAndNotify,CANCEL:CANCEL,SAVE_SUCCESS:SAVE_SUCCESS,SAVE_ERROR:SAVE_ERROR,DELETE_SUCCESS:DELETE_SUCCESS,DELETE_ERROR:DELETE_ERROR}}angular.module("stapi").factory("stCrudTools",stCrudToolsUtils).factory("stCrudToolsUtils",stCrudToolsUtils)}(),function(){function cacheGet($localStorage,$cookieStore,stUtil,$injector){var _getCacheName=function(){var login=$cookieStore.get("usuarioSistema").originalLogin;return"cacheGet"+login},_add=function(url,objetos){var nomeCache=_getCacheName();if($localStorage[nomeCache]||($localStorage[nomeCache]={}),$localStorage[nomeCache][url]||($localStorage[nomeCache][url]=[]),objetos.length)for(var i in objetos)_updateObject(url,objetos[i]);else _updateObject(url,objetos)},_updateObject=function(url,objeto){var index=stUtil.buscaOb($localStorage[_getCacheName()][url],objeto.id,"id");-1!=index?$localStorage[_getCacheName()][url][index]=objeto:$localStorage[_getCacheName()][url].push(objeto)},_getAll=function(url){var nomeCache=_getCacheName();if(!$localStorage[nomeCache])return[];var itens=$localStorage[nomeCache][url];return itens},_get=function(url,label,like){var nomeCache=_getCacheName();if(!$localStorage[nomeCache])return[];var itens=$localStorage[nomeCache][url];return label&&like&&(itens=itens.filter(function(item){return item[label]&&-1!=item[label].toLowerCase().indexOf(like.toLowerCase())?item:void 0})),itens},_getObjectById=function(url,id){var index=stUtil.buscaOb($localStorage[_getCacheName()][url],id,"id");return $localStorage[_getCacheName()][url][index]},_cleanAll=function(url){$localStorage[_getCacheName()]&&delete $localStorage[_getCacheName()][url]},_del=function(url,id){var index=stUtil.buscaOb($localStorage[_getCacheName()][url],id,"id");$localStorage[_getCacheName()][url].splice(index,1)},_getOfflineCache=function(callback){var stService=$injector.get("stService");_cleanAll("cliente"),_cleanAll("produto"),_cleanAll("tagsProduto"),stService.getLikeMap("cliente",["disable=0"],0,0,"").then(function(clientes){_add("cliente",clientes.itens),stService.getLikeMap("produto",["disable=0"],0,0,"").then(function(produtos){var prods=produtos.itens;_add("produto",prods);var tags=[];for(var i in prods)prods[i].tag&&-1==tags.indexOf(prods[i].tag)&&tags.push(prods[i].tag);_add("tagsProduto",tags),callback("ok")})["catch"](function(){callback()})})["catch"](function(){callback()})};return{add:_add,getCacheName:_getCacheName,getAll:_getAll,get:_get,cleanAll:_cleanAll,updateObject:_updateObject,getObjectById:_getObjectById,delObjectById:_del,getOfflineCache:_getOfflineCache}}function cachePost($localStorage,$cookieStore,$rootScope){var _add=function(url,objeto,callback){var idFilial=0;$rootScope.currentFilial&&(idFilial=$rootScope.currentFilial.id),objeto.idFilial=idFilial,url=url+"?filialId="+idFilial+"&&isCachePost=true",$localStorage.cachePost||($localStorage.cachePost=[]);var login,uS=$cookieStore.get("usuarioSistema");login=uS?uS.originalLogin:"shared@shared";var obCache={url:url,objeto:objeto,login:login};$localStorage.cachePost.push(obCache),callback&&callback(objeto)};return{add:_add}}angular.module("stapi").factory("cachePost",cachePost).factory("cacheGet",cacheGet)}(),function(){function syncCachePost(onlineStatus){return{restrict:"E",templateUrl:"global/st-api/st-sync/html/syncCachePost.html",scope:{},controllerAs:"vm",bindToController:!0,controller:function($localStorage,$interval,$timeout,stService,$rootScope,stUtil,onlineStatus,$scope,loginUtil,st,$mdDialog){var vm=this,_start=function(){function executePosts(i,tam){return i>=tam||!$localStorage.cachePost[0]||0==onlineStatus.isOnline()?(executando=!1,void($rootScope.executandoCachePost=!1)):(vm.indexCachePostInExcecution=i+1,void stService.executePost($localStorage.cachePost[0].url,$localStorage.cachePost[0].objeto).then(function(data){$localStorage.cachePost.splice(0,1),$timeout(function(){executePosts(i+1,tam)},300)})["catch"](function(erro,status){erro&&401!=status&&(st.evt({evento:"erro_cache_post",descricao:erro,descricao_2:JSON.stringify($localStorage.cachePost[0])}),$localStorage.cachePost.splice(0,1),$mdDialog.show({animation:!0,size:"lg",templateUrl:"global/st-api/app-login/template-route/manutencao.html"})),$timeout(function(){executePosts(i+1,tam)},5e3)}))}$localStorage.cachePost||($localStorage.cachePost=[]);var executando=!1,executar=function(){1!=executando&&0!=onlineStatus.isOnline()&&0!=loginUtil.isLogado()&&(executando=!0,$rootScope.executandoCachePost=!0,vm.sizeCachePostInExcecution=$localStorage.cachePost.length,executePosts(0,$localStorage.cachePost.length))};$interval(executar,5e3)};_start()}}}angular.module("stapi").directive("syncCachePost",syncCachePost)}(),function(){angular.module("stapi").factory("st",function($rootScope,$cookieStore){var _evt=function(evt){},_leadEvt=function(evt){$cookieStore.get("usuarioSistema")};return{evt:_evt,leadEvt:_leadEvt}}).factory("stUtil",function($rootScope,$filter,$injector){var _transformJSONToSqlComparators=function(obj){if(!obj)return[];var querys=[];for(var key in obj)querys.push(key+" = '"+obj[key]+"'");return querys=querys.filter(function(value){return value.length>0?value:void 0})},_removerAcentos=function(str){console.log("Antes: "+str);for(var rExps=[{re:/[\xC0-\xC6]/g,ch:"A"},{re:/[\xE0-\xE6]/g,ch:"a"},{re:/[\xC8-\xCB]/g,ch:"E"},{re:/[\xE8-\xEB]/g,ch:"e"},{re:/[\xCC-\xCF]/g,ch:"I"},{re:/[\xEC-\xEF]/g,ch:"i"},{re:/[\xD2-\xD6]/g,ch:"O"},{re:/[\xF2-\xF6]/g,ch:"o"},{re:/[\xD9-\xDC]/g,ch:"U"},{re:/[\xF9-\xFC]/g,ch:"u"},{re:/[\xD1]/g,ch:"N"},{re:/[\xF1]/g,ch:"n"}],i=0,len=rExps.length;len>i;i++)str=str.replace(rExps[i].re,rExps[i].ch);return console.log("Depois: "+str),str},_disableFocus=function(){$("#anchor_cima").focus()},_getDayOfIndex=function(index){switch(index){case 0:return"segunda-feira";case 1:return"terça-feira";case 2:return"quarta-feira";case 3:return"quinta-feira";case 4:return"sexta-feira";case 5:return"sábado";case 6:return"domingo"}},_openLogin=function(modal){modal.open({animation:!0,templateUrl:"view/login/login.html",size:"lg",controller:function($scope,loginService,$rootScope){$scope.logar=function(login){$scope.logar=function(login){loginService.logar(login).then(function(data){var authToken=data.token;$rootScope.authToken=authToken})}},$scope.fechar=function(ele){ele.$dismiss("cancel")}}})},_getCountObs=function(obs,attrCount,attrComp,value){var total=0;for(i in obs)attrComp?_compareJson(obs[i],value,attrComp)&&(total+=_getValueOfNivel(obs[i],attrCount)):total+=_getValueOfNivel(obs[i],attrCount);return total},_formatData=function(data){if("object"==typeof data||"number"==typeof data)return $filter("date")(data,"yyyy-MM-dd");if(!data||""==data)return"";var format="",dia=parseInt(data.substring(0,2)),mes=data.substring(3,5),ano=data.substring(6);return format=ano+"-"+mes+"-"+dia},_getNameMonth=function(n){switch(n){case 1:return"Janeiro";case 2:return"Fevereiro";case 3:return"Março";case 4:return"Abril";case 5:return"Maio";case 6:return"Junho";case 7:return"Julho";case 8:return"Agosto";case 9:return"Setembro";case 10:return"Outubro";case 11:return"Novembro";case 12:return"Dezembro"}return""},_showMessage=function(titulo,mensagem,classe,actionText){classe="md-primary"|classe,"danger"==classe?classe="md-accent":"info"==classe&&(classe="md-primary");var $mdToast=$injector.get("$mdToast"),toast=$mdToast.simple().textContent(mensagem).action(""|actionText).highlightAction(angular.isDefined(actionText)).highlightClass(classe).position("bottom");return $mdToast.show(toast)},_buscaOb=function(array,query,attr){var attrs=[];attr&&(attrs=attr.split("."));for(var i in array){if(attr&&1==attrs.length&&array[i][attrs[0]]==query)return i;if(attr&&2==attrs.length&&array[i][attrs[0]][attrs[1]]==query)return i;if(array[i]==query)return i}return-1},_getValueOfNivel=function(ob,attr){var result;if(!attr)return void 0;var nvs=attr.split(".");switch(nvs.length){case 0:result=ob;break;case 1:result=ob[nvs[0]];break;case 2:result=ob[nvs[0]]?ob[nvs[0]][nvs[1]]:void 0;break;case 3:result=ob[nvs[0]]&&ob[nvs[0]][nvs[1]]?ob[nvs[0]][nvs[1]][nvs[2]]:void 0;break;case 4:result=ob[nvs[0]]&&ob[nvs[0]][nvs[1]]&&ob[nvs[0]][nvs[1]][nvs[2]]?ob[nvs[0]][nvs[1]][nvs[2]][nvs[3]]:void 0;break;case 5:result=ob[nvs[0]]&&ob[nvs[0]][nvs[1]]&&ob[nvs[0]][nvs[1]][nvs[2]]&&ob[nvs[0]][nvs[1]][nvs[2]][nvs[3]]?ob[nvs[0]][nvs[1]][nvs[2]][nvs[3]][nvs[4]]:void 0}return result},_setValueOfNivel=function(ob,attr,value){var nvs=attr.split(".");switch(nvs.length){case 0:break;case 1:ob[nvs[0]]=value;break;case 2:ob[nvs[0]]=ob[nvs[0]]||{},ob[nvs[0]][nvs[1]]=value;break;case 3:ob[nvs[0]][nvs[1]]=ob[nvs[0]][nvs[1]]||{},ob[nvs[0]][nvs[1]][nvs[2]]=value;break;case 4:ob[nvs[0]][nvs[1]][nvs[2]]||ob[nvs[0]][nvs[1]][nvs[2]]||{},ob[nvs[0]][nvs[1]][nvs[2]][nvs[3]]=value;break;case 5:ob[nvs[0]][nvs[1]][nvs[2]][nvs[3]]=ob[nvs[0]][nvs[1]][nvs[2]][nvs[3]]||{},ob[nvs[0]][nvs[1]][nvs[2]][nvs[3]][nvs[4]]=value}return ob},_compareJson=function(ob,value,attr){if(!attr||0==attr.split(".").length)return ob==value;var key,nvs=attr.split(".");switch(nvs.length){case 1:key=ob[nvs[0]];break;case 2:key=ob[nvs[0]][nvs[1]];break;case 3:key=ob[nvs[0]][nvs[1]][nvs[2]];break;case 4:key=ob[nvs[0]][nvs[1]][nvs[2]][nvs[3]];break;case 5:key=ob[nvs[0]][nvs[1]][nvs[2]][nvs[3]][nvs[4]]}return key==value};return{getCountObs:_getCountObs,getNameMonth:_getNameMonth,formatData:_formatData,showMessage:_showMessage,buscaOb:_buscaOb,openLogin:_openLogin,getValueOfNivel:_getValueOfNivel,setValueOfNivel:_setValueOfNivel,getValue:_getValueOfNivel,setValue:_setValueOfNivel,compareJson:_compareJson,disableFocus:_disableFocus,removerAcentos:_removerAcentos,getDayOfIndex:_getDayOfIndex,transformJSONToSqlComparators:_transformJSONToSqlComparators}}).factory("s",function(){var _format=function(texto,tam,limiter){
for(limiter&&(texto=_setLimiter(texto,limiter,"."));texto.length<tam;)texto+=" ";return texto},_setLimiter=function(value,max,tail){if(!value)return"";if(max=parseInt(max,10),!max)return value;if(value.length<=max)return value;value=value.substr(0,max);var lastspace=value.lastIndexOf(" ");return-1!=lastspace&&(("."==value.charAt(lastspace-1)||","==value.charAt(lastspace-1))&&(lastspace-=1),value=value.substr(0,lastspace)),value+(tail||" …")};return _format}).factory("printUtil",function($rootScope,$http,$filter,s,stUtil,movUtil){var FONT_BOLD=1,FONT_ITALIC=2,getFooterPrint=function(){var linhas=[],hoje=new Date;return linhas.push({texto:"TRACO"}),linhas.push({texto:"Emitido em "+$filter("date")(hoje,"dd/MM/yyyy")+" as "+$filter("date")(hoje,"HH:mm:ss")}),linhas},getHeaderPrint=function(tipoPessoa,nomePessoa){var linhas=[],config=$rootScope.config.confs,nome="  "+config.nomeUsuario,telefone="           "+config.telefone||"";if(linhas.push({texto:nome,fontSize:22,fontWeight:FONT_ITALIC,fontFamily:"ARIAL"}),linhas.push({texto:telefone,fontSize:12,fontWeight:FONT_BOLD,fontFamily:"ARIAL"}),linhas.push({texto:"TRACO"}),tipoPessoa&&nomePessoa){var descricaoPessoa=tipoPessoa+" : "+nomePessoa;descricaoPessoa=$filter("uppercase")(descricaoPessoa),linhas.push({texto:descricaoPessoa})}return linhas.push({texto:"TRACO"}),linhas},_printMovs=function(movs){var config=$rootScope.config.confs,tipoPessoa=movs[0].pessoa.tipo_pessoa,nomePessoa=movs[0].pessoa.nome,linhas=getHeaderPrint(tipoPessoa,nomePessoa);for(i in movs){var mov=movs[i],data=new Date(mov.data),dataFormatada=$filter("date")(data,"dd/MM/yyyy"),diaSemana=$filter("date")(data,"EEEE"),totalMov=$filter("number")(mov.valor,2);linhas.push({texto:dataFormatada+" ("+diaSemana+") - R$ "+totalMov});var pedidos=mov.pedidos,headerPedido=s("QUANT",5)+" "+s("PRODUTO",17)+" "+s("UNIT",5)+"  "+s("SUB-TOTAL",10);linhas.push({texto:headerPedido,fontSize:8,fontWeight:1});for(var j in pedidos){var ped=pedidos[j],totalPedido=$filter("number")(ped.quantidade*ped.valorUnitario,2),valorUnitario=$filter("number")(ped.valorUnitario,2),nomeProduto=ped.produto.nome;ped.opcao&&(nomeProduto+=" "+ped.opcao.nomeOpcao);var descPedido=s(ped.quantidade+"x",5)+" "+s(nomeProduto,17,16)+" "+s(valorUnitario,5)+"  "+s(totalPedido,10);linhas.push({texto:descPedido,fontSize:8,fontWeight:1})}}var totalForMovs=movUtil.getTotalMovs(movs);totalForMovs=$filter("number")(totalForMovs,2),linhas.push({texto:"Total: R$ "+totalForMovs}),linhas=linhas.concat(getFooterPrint());var objectPrint={larguraPapel:config.larguraPapelCupom||80,linhas:linhas},urlPrint=(config.urlImpressoraCupom||"http://localhost:1220")+"/print",req={method:"POST",url:urlPrint,headers:{"Content-Type":"text/plain"},data:objectPrint};$http(req).then(function(data){})["catch"](function(msg){stUtil.showMessage("","Ocorreu ao imprimir em '"+urlPrint+"'","danger")})};return{printMovs:_printMovs}}).factory("$stDetalhe",function($http,config,$mdDialog){var _open=function(template,ob,$scope_,callback){$mdDialog.show({animation:!0,templateUrl:template,size:"lg",controller:function($scope){$scope.ob=ob,$scope.objeto=ob,$scope.parente=$scope_,$scope.fechar=function(ele){ele.$dismiss("cancel"),callback($scope.objeto)}}})};return{open:_open}})}(),function(){angular.module("stapi").factory("onlineStatus",["$window","$rootScope",function($window,$rootScope){var onlineStatus={};return onlineStatus.onLine=$window.navigator.onLine,onlineStatus.isOnline=function(){return onlineStatus.onLine},$window.addEventListener("online",function(){onlineStatus.onLine=!0,$rootScope.$digest()},!0),$window.addEventListener("offline",function(){onlineStatus.onLine=!1,$rootScope.$digest()},!0),onlineStatus}])}(),function(){angular.module("stapi").filter("dayOfWeek",function(){return function(dayIndex){switch(dayIndex){case 1:return"Domingo";case 2:return"Segunda";case 3:return"Terça";case 4:return"Quarta";case 5:return"Quinta";case 6:return"Sexta";case 7:return"Sábado"}return""}}).factory("dateUtil",function($rootScope,$filter,stUtil){function getDesdeInicioAno(){var periodoDe=new Date;return periodoDe.setDate(1),periodoDe.setMonth(0),{de:periodoDe,ate:new Date}}function getSemanaPassada(){var hoje=new Date,periodoDe=new Date,inicioSemana=parseInt($rootScope.config.confs.inicio_semana);periodoDe.setDate(hoje.getDate()-(hoje.getDay()+7)+inicioSemana);var periodoAte=new Date;return periodoAte.setDate(hoje.getDate()-hoje.getDay()+(inicioSemana-1)),{de:periodoDe,ate:periodoAte}}function getMesAtual(){var atual=new Date,lastDay=_daysInMonth(atual.getMonth()+1,atual.getYear()),periodoDe=new Date;new Date;periodoDe.setDate(1);var periodoAte=new Date;return periodoAte.setDate(lastDay),{de:periodoDe,ate:periodoAte}}function getSemanaAtual(){var hoje=new Date,periodoDe=new Date,inicioSemana=parseInt($rootScope.config.confs.inicio_semana);console.log("date: "+hoje.getDate()),console.log("day: "+hoje.getDay()),console.log("inicioSemana: "+inicioSemana),periodoDe.setDate(hoje.getDate()-hoje.getDay()+inicioSemana);var periodoAte=new Date;return periodoAte.setDate(periodoDe.getDate()+6),{de:periodoDe,ate:periodoAte}}function getNextDays(days){var hoje=new Date,periodoDe=new Date;periodoDe.setDate(hoje.getDate()+days);var periodoAte=new Date;return{de:periodoDe,ate:periodoAte}}function getLastDays(days){var hoje=new Date,periodoDe=new Date;periodoDe.setDate(hoje.getDate()-days);var periodoAte=new Date;return{de:periodoDe,ate:periodoAte}}function _getQueryOfPeriod(column,de,ate){var query=column+" between '"+_formatDate(de)+"' and '"+_formatDate(ate)+"'";return query}var _getPeriodOf=function(p,n){var intervalo;return"SEMANA_PASSADA"==p?intervalo=getSemanaPassada():"SEMANA_ATUAL"==p?intervalo=getSemanaAtual():"MES_ATUAL"==p?intervalo=getMesAtual():"LAST_DAYS"==p?intervalo=getLastDays(n):"NEXT_DAYS"==p?intervalo=getNextDays(n):"HOJE"==p?intervalo={de:new Date,ate:new Date}:"DESDE_INICIO_ANO"==p?intervalo=getDesdeInicioAno():console.log("tipo não definido em getPeridoOf()"),intervalo.de.setHours(0,0,0),intervalo.ate.setHours(23,59,59),intervalo},_formatDate=function(data){if("object"==typeof data||"number"==typeof data)return $filter("date")(data,"yyyy-MM-dd");if(!data||""==data)return"";var format="";if(1==RegExp(/\d{4}\-\d{2}\-(\d{2}|\d{1})/).test(data)){var dia=parseInt(data.substring(8)),mes=data.substring(5,7),ano=data.substring(0,4);format=ano+"-"+mes+"-"+dia}else if(1==RegExp(/\d{2}\/\d{2}\/\d{4}/).test(data)){var dia=parseInt(data.substring(0,2)),mes=data.substring(3,5),ano=data.substring(6);dia=dia.toString(),1==dia.length&&(dia="0"+dia),format=ano+"-"+mes+"-"+dia}else if(1==RegExp(/\d{1}\/\d{2}\/\d{4}/).test(data)){var dia=parseInt(data.substring(0,1)),mes=data.substring(2,4),ano=data.substring(5);format=ano+"-"+mes+"-"+dia}return format},_getDate=function(data){var formatData=_formatDate(data),dia=parseInt(formatData.substring(8)),mes=parseInt(formatData.substring(5,7)),ano=parseInt(formatData.substring(0,4)),data=new Date(ano,mes-1,dia);return data},_daysInMonth=function(month,year){var dd=new Date(year,month,0);return dd.getDate()},_incrementaData=function(data,modo){switch(modo&&0!=modo||(modo=3),modo){case 1:data.setDate(data.getDate()+1);break;case 3:data.setMonth(data.getMonth()+1);break;default:data.setMonth(data.getMonth()+1)}return data},_daysBetween=function(date1_ms,date2_ms){var ONE_DAY=864e5,difference_ms=Math.abs(date1_ms-date2_ms);return Math.round(difference_ms/ONE_DAY)},_getBrFormat=function(value){return $filter("date")(value,"dd/MM/yyyy")},_getDayNameOfIndex=function(index){switch(index){case 0:return"segunda-feira";case 1:return"terça-feira";case 2:return"quarta-feira";case 3:return"quinta-feira";case 4:return"sexta-feira";case 5:return"sábado";case 6:return"domingo"}};return{getPeriodOf:_getPeriodOf,getQueryOfPeriod:_getQueryOfPeriod,formatDate:_formatDate,getDate:_getDate,daysInMonth:_daysInMonth,incrementaData:_incrementaData,daysBetween:_daysBetween,getBrFormat:_getBrFormat,getDayNameOfIndex:_getDayNameOfIndex}})}(),function(){angular.module("stapi").directive("ovtsZoomControls",function($window,$document,$timeout){return{restrict:"A",replace:!0,transclude:!0,template:'<div class="ovts-zoom-controls"></div>',scope:{},controllerAs:"zoom",controller:function($scope){this["in"]=function(){$scope.currentStep<$scope.stepCnt&&($scope.currentStep+=1)},this.out=function(){$scope.currentStep>0&&($scope.currentStep-=1)},this.isMaxedIn=function(){return $scope.currentStep==$scope.steps.length-1},this.isMaxedOut=function(){return 0==$scope.currentStep}},link:function($scope,ele,attrs,controller,transclude){function calc(){function calculateSteps(){var width=eleTarget.clientWidth,height=eleTarget.clientHeight,minWidthScale=minWidth/width||-(1/0),minHeightScale=minHeight/height||-(1/0),maxWidthScale=maxWidth/width||1/0,maxHeightScale=maxHeight/height||1/0,minScale=Math.max(minWidthScale,minHeightScale),maxScale=Math.min(maxWidthScale,maxHeightScale),minLog=Math.log(minScale),maxLog=Math.log(maxScale);if(minScale>1||1>maxScale)steps.push(1);else for(var initalStep=Math.round(stepCnt*-minLog/(maxLog-minLog)),i=0;stepCnt>=i;i++){var step;step=initalStep>i?-minLog/initalStep*i+minLog:i>initalStep?maxLog*(i-initalStep)/(stepCnt-initalStep):0,steps.push(Math.pow(Math.E,step))}return steps.indexOf(1)}function applyTransformOrigin(element,cssValue){return element.style.transformOrigin=cssValue,element.style.webkitTransformOrigin=cssValue,element.style.mozTransformOrigin=cssValue,element.style.msTransformOrigin=cssValue,element.style.oTransformOrigin=cssValue}function applyTransform(element,value){var cssValue="scale("+value+","+value+")";return element.style.transform=cssValue,element.style.webkitTransform=cssValue,element.style.mozTransform=cssValue,element.style.msTransform=cssValue,element.style.oTransform=cssValue}function applyAnimation(element,cssValue){return element.style.transition=cssValue,element.style.webkitTransition=cssValue,element.style.mozTransition=cssValue,element.style.oTransition=cssValue}var eleControls=ele[0],steps=$scope.steps=[],stepCnt=$scope.stepCnt=options.stepCnt||4,animation=options.animationFn||".7s ease-out",transformOrigin=options.transformOrigin||"center top",minHeight=options.minHeight,minWidth=options.minWidth,maxHeight=options.maxHeight,maxWidth=options.maxHeight,minWidthOffset=(options.min,options.max,options.minWidthOffset||0),minHeightOffset=options.minHeightOffset||0,maxWidthOffset=options.maxWidthOffset||0,maxHeightOffset=options.maxHeightOffset||0;options.offsetX||0;"initial"===minWidth&&(minWidth=eleTarget.clientWidth),"initial"===minHeight&&(minHeight=eleTarget.clientHeight),"window"===minWidth&&(minWidth=$window.innerWidth),"window"===minHeight&&(minHeight=$window.innerHeight),"initial"===maxWidth&&(maxWidth=eleTarget.clientWidth),"initial"===maxHeight&&(maxHeight=eleTarget.clientHeight),"window"===maxWidth&&(maxWidth=$window.innerWidth),"window"===maxHeight&&(maxHeight=$window.innerHeight),minHeight+=minWidthOffset,minHeight+=minHeightOffset,maxWidth+=maxWidthOffset,maxHeight+=maxHeightOffset,transclude($scope,function(nodes){angular.element(eleControls).append(nodes)}),$scope.currentStep=calculateSteps(),applyTransformOrigin(eleTarget,transformOrigin),$scope.$watch("currentStep",function(currentStep,oldStep){currentStep!==oldStep&&applyAnimation(eleTarget,animation),applyTransform(eleTarget,steps[currentStep])})}var options=$scope.$eval(attrs.ovtsZoomControls)||{},eleTarget=$document[0].querySelector(options.target);$scope.$watch(function(){return[eleTarget.clientWidth,eleTarget.clientHeight]},calc,!0),$window.addEventListener("resize",calc)}}}).directive("ngEnter",function(){return{link:function(scope,element,attrs){element.bind("keydown keypress",function(event){13===event.which&&(scope.$apply(function(){scope.$eval(attrs.ngEnter)}),event.preventDefault())})}}}).directive("htmlView",function(){return{scope:{titulo:"=",content:"="},templateUrl:"global/st-api/st-util/template-module/htmlView.html",bindToController:!0,controllerAs:"vm",controller:function(){}}}).directive("htmlCompile",function($compile){return{scope:{html:"="},controller:function($scope,$element){$scope.$watch("html",function(template){var linkFn=$compile(template),content=linkFn($scope);$element.html(content)})}}}).directive("viewChose",function(){return{restrict:"E",transclude:!0,scope:{viewType:"="},templateUrl:"global/st-api/st-util/template-module/viewChose.html",bindToController:!0,controllerAs:"vm",controller:function(configUtil){var vm=this;vm.viewType||(vm.viewType="grid"),vm.change=function(){vm.viewType="grid"==vm.viewType?"table":"grid",configUtil.setConfig("viewType",vm.viewType)}}}}).directive("delayCount",function(onlineStatus){return{restrict:"E",template:"{{count}}",scope:{number:"=",time:"=",finish:"="},controller:function($scope,$interval){$scope.count=0,$interval(function(){return $scope.count<$scope.number?void $scope.count++:void($scope.finish=!0)},$scope.time||300)}}}).directive("networkButtonStatus",function(onlineStatus){return{restrict:"E",templateUrl:"global/st-api/st-util/template-module/networkButtonStatus.html",controller:function($scope){$scope.onlineStatus=onlineStatus,$scope.$watch("onlineStatus.isOnline()",function(online){$scope.online_status=online})}}}).directive("fileModel",["$parse",function($parse){return{restrict:"A",link:function(scope,element,attrs){var model=$parse(attrs.fileModel),modelSetter=model.assign;element.bind("change",function(){scope.$apply(function(){modelSetter(scope,element[0].files[0])})})}}}]).directive("stInitial",function(){return{restrict:"A",controller:["$scope","$element","$attrs","$parse",function($scope,$element,$attrs,$parse){var getter,setter,val;val=$attrs.ngInitial||$attrs.value,getter=$parse($attrs.ngModel),(setter=getter.assign)($scope,val)}]}}).directive("buttonInfoOb",function($mdDialog,filialUtil){return{link:function(scope,element,attrs){element.bind("click",function(){var objeto=JSON.parse(attrs.objeto),historicos=objeto.historicoObjeto.split(","),content="";for(var i in historicos)content+="<p>"+historicos[i]+"</p>";$mdDialog.show($mdDialog.alert().parent(angular.element(document.body)).clickOutsideToClose(!0).title("Informações").htmlContent(content).ariaLabel("Informações").ok("ok"))})}}}).directive("floatButtonAdd",function(){return{restrict:"E",templateUrl:"global/st-api/st-util/template-module/buttonAdd.html",scope:{tooltipLabel:"@"}}}).directive("estadosCidades",function(){return{restrict:"E",templateUrl:"global/st-api/st-util/template-module/estadosCidades.html",scope:{estado:"=",cidade:"=",codigoUf:"=",codigoMunicipio:"=",nomeMunicipio:"=",uf:"="},bindToController:!0,controller:"estadosCidadesController as vm"}}).directive("stNoItens",function(){return{template:'<p class="text-muted" style="padding:10px;"><i class="fa fa-exclamation-circle" aria-hidden="true"></i> {{label}}</p>',scope:{label:"="}}}).directive("destaqueTexto",function(){return{restrict:"E",template:"<strong><span class='{{class}}' ng-class=\"{'busca-destaque':(first!=-1 && $index>=first && $index<=last)}\" ng-repeat='c in texto track by $index'>{{c}}</span></strong>",scope:{busca:"=",texto:"=","class":"="},controller:function($scope){if($scope.busca&&$scope.busca.length>0){var texto=$scope.texto.toLowerCase(),busca=$scope.busca.toLowerCase();$scope.first=texto.indexOf(busca),$scope.last=$scope.first+busca.length}else $scope.first=-1,$scope.last=-1}}}).directive("buttonExpressCad",function(movUtil,stService){return{restrict:"E",templateUrl:"global/st-api/st-util/template-module/buttonExpressCad.html",controller:function($scope){$scope.cadDespesa=function(){var mov={tipo:1};movUtil.openMov(mov,function(){})}}}}).directive("stItemSelection",function(stService){return{restrict:"E",require:"ngModel",templateUrl:"global/st-api/st-util/template-module/itemSelection.html",scope:{maxItens:"=",objectOp:"=",label:"=",extraLabel:"="},link:function($scope,elements,attrs,ctrl){$scope.setPagina=function(pagina){$scope.pagina=pagina,stService.getLikeMap($scope.objectOp,[""],pagina,$scope.maxItens||0,"").then(function(data){$scope.itens=data.itens})},$scope.setPagina(0),$scope.selecionarItem=function(item){ctrl.$setViewValue(item)}}}}).directive("stShow",function($window,$animate){return{restrict:"A",multiElement:!0,link:function(scope,element,attr){scope.$watch(attr.stShow,function(value){1==value?element.addClass("st-show"):element.removeClass("st-show")})}}}).directive("stPrint",function($window){return{restrict:"A",scope:{},link:function(scope,element,attr){element.bind("click",function(){var ele=$("#"+element.attr("id-print"));ele.addClass("printShow"),ele.removeClass("printHide"),$window.print(),ele.removeClass("printShow"),ele.addClass("printHide")})}}}).directive("loading",function(){return{restrict:"E",scope:{label:"="},replace:!0,template:'<div class="loading"><i class="fa fa-refresh fa-spin"></i> <i>{{label}}</i></div>',link:function(scope,element,attr){scope.$watch("loading",function(val){val?scope.loadingStatus="true":scope.loadingStatus="false"})}}}).directive("stList",function($filter){return{templateUrl:"view/api/st-list.html",restrict:"E",scope:{itens:"=",left:"@",right:"@",link:"@",tl:"@",tr:"@",cl:"@",cr:"@",bl:"@",br:"@",tamleft:"@",tamright:"@",labelitem:"@"},link:function($scope,element,attrs){$scope.tamleft||($scope.tamleft=6),$scope.tamright||($scope.tamright=6),$scope.getLt=function(item,position){$scope[position]||"cl"!=position||(position="left"),$scope[position]||"cr"!=position||(position="right");var frase="";if(!$scope[position])return"";frase=$scope[position];var regex,i,expressoes=frase.split(","),termos=[],termo={atributo:"",valor:0,tipo:"",exp:""};for(var i in expressoes){if(termo={},-1==expressoes[i].indexOf("["))regex=new RegExp(/\'[\w | \W]+\'/),termo.valor=regex.exec(expressoes[i])[0].replace(/\'/g,""),termo.tipo="string",termo.atributo=null,termo.exp=expressoes[i];else{regex=new RegExp(/\[[\w |\W]+\:/);var atributo=regex.exec(expressoes[i])[0];atributo=atributo.replace("[",""),atributo=atributo.replace(":","");var atributos=atributo.split(".");termo.atributo=atributos[0];var sub_=atributo.split(".")[1],valor=item[termo.atributo];sub_&&(valor=valor[sub_]),termo.valor=valor,regex=new RegExp(/\'[\w | \W]+\'/),termo.tipo=regex.exec(expressoes[i])[0].replace(/\'/g,""),termo.exp=expressoes[i]}termos.push(termo)}var j,lt="";for(var j in termos)"money"==termos[j].tipo?(lt="R$ ",termos[j].valor=$filter("number")(termos[j].valor,2)):"string"==termos[j].tipo&&(termos[j].valor=$filter("uppercase")(termos[j].valor)),lt+=termos[j].valor;return lt},$scope.getLink=function(item){var link=$scope.link;if(!link)return"#";var pattern=new RegExp(/\[[a-z]+\]/),atributo=pattern.exec($scope.link),attr=atributo[0];return attr=attr.replace("[",""),attr=attr.replace("]",""),link=link.replace(pattern,item[attr])}}}}).directive("stCheck",function(){return{templateUrl:"global/st-api/st-util/template-module/stCheck.html",transclude:!0,scope:{ngModel:"=",ngChange:"=",ngDisabled:"=",label:"=",labelClass:"="}}}).directive("stRelatorio",function(relatorioService,stUtil){return{templateUrl:"view/relatorio/relatorioDirective.html",transclude:!0,scope:{url:"=",nomeObjeto:"="},controller:function($scope){$scope.dataDe=new Date,$scope.dataAte=new Date,$scope.teste=function(){},$scope.gerarRelatorio=function(column,operador,valueColumn,countColumn,query,nomeRelatorio){$scope.nomeRelatorio=nomeRelatorio;var ops={};ops.nomeObjeto=$scope.nomeObjeto,ops.column=column,ops.operador=operador,ops.countColumn=countColumn,ops.valueColumn=valueColumn,ops.url=$scope.url,ops.querys=[],ops.labels=["Dinheiro","Cheque"],ops.querysLabel=[],ops.dataDe=stUtil.formatData($scope.dataDe),ops.dataAte=stUtil.formatData($scope.dataAte),ops.querysLabel=ops.querys,query&&query.length>0&&ops.querys.push(query),relatorioService.getProjecoes(ops,function(data){$scope.proj=data})}}}}).directive("convertToNumber",function(){return{require:"ngModel",link:function(scope,element,attrs,ngModel){ngModel.$parsers.push(function(val){return val?parseInt(val,10):null}),ngModel.$formatters.push(function(val){return val?""+val:null})}}}).directive("navClick",function(){return{restrict:"A",link:function(scope,element,attrs){element.on("click",function(event){var elementoMenu=$("#elementoMenu");elementoMenu.attr("class","sidebar-nav navbar-collapse collapse")})}}}).service("anchorScroll",function(){this.scrollTo=function(eID){function currentYPosition(){return self.pageYOffset?self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0}function elmYPosition(eID){for(var elm=document.getElementById(eID),y=elm.offsetTop,node=elm;node.offsetParent&&node.offsetParent!=document.body;)node=node.offsetParent,y+=node.offsetTop;return y}var startY=currentYPosition(),stopY=elmYPosition(eID),distance=stopY>startY?stopY-startY:startY-stopY;if(100>distance)return void scrollTo(0,stopY);var speed=Math.round(distance/100);speed>=20&&(speed=20);var step=Math.round(distance/25),leapY=stopY>startY?startY+step:startY-step,timer=0;if(stopY>startY)for(var i=startY;stopY>i;i+=step)setTimeout("window.scrollTo(0, "+leapY+")",timer*speed),leapY+=step,leapY>stopY&&(leapY=stopY),timer++;else for(var i=startY;i>stopY;i-=step)setTimeout("window.scrollTo(0, "+leapY+")",timer*speed),leapY-=step,stopY>leapY&&(leapY=stopY),timer++}}).directive("stCollapsePanel",function($timeout){return{restrict:"E",transclude:!0,templateUrl:"global/st-api/st-util/template-module/stCollapsePanel.html",scope:{titulo:"=",icone:"=",show:"=",extraClass:"="},link:function($scope){}}}).directive("stAccordion",function(){return{restrict:"E",replace:!0,transclude:!0,template:'<div class="panel-group" ng-transclude></div>',scope:{accordionIn:"="},link:function(scope,elem,attrs){var id=elem.attr("id");id||(id="btst_acc"+scope.$id,elem.attr("id",id));for(var arr=elem.find(".accordion-toggle"),i=0;i<arr.length;i++)$(arr[i]).attr("data-parent","#"+id),$(arr[i]).attr("href","#"+id+"collapse"+i);var arr=elem.find(".panel-collapse");1==scope.accordionIn&&$(arr[0]).addClass("in");for(var x=0;x<arr.length;x++)$(arr[x]).attr("id",id+"collapse"+x)},controller:function(){}}}).directive("stAccordionPanel",function(){return{require:"^stAccordion",restrict:"E",replace:!0,transclude:!0,scope:{title:"=",idPanel:"@"},template:'<div class="panel panel-default panel-pdvficha">	<div id="{{idPanel}}" data-toggle="collapse" class="panel-heading accordion-toggle collapsed">   	{{title}} <i class="fa fa-edit"></i>	</div>	<div class="panel-collapse collapse panel-body" ng-transclude>	</div></div>',link:function(scope,elem,attrs){scope.$watch("title",function(){var hdr=elem.find(".accordion-toggle");hdr.html(scope.title+' <i class="fa arrow"></i>')})}}}).filter("indexDay",function(stUtil){return function(value){return stUtil.getDayOfIndex(value)}}).filter("limiter",function(){return function(value,max,tail){if(!value)return"";if(max=parseInt(max,10),!max)return value;if(value.length<=max)return value;value=value.substr(0,max);var lastspace=value.lastIndexOf(" ");return-1!=lastspace&&(("."==value.charAt(lastspace-1)||","==value.charAt(lastspace-1))&&(lastspace-=1),value=value.substr(0,lastspace)),value+(tail||" …")}}).filter("tojson",function(){return function(value){return value?JSON.parse(value):""}}).directive('autoFocus"',function($timeout){return{link:function(scope,element){console.log("Chamou o focus"),$timeout(function(){element[0].focus(),console.log("Chamou o focus")})}}}).directive("focusMe",function($timeout){return{scope:{trigger:"=focusMe"},require:"ngModel",link:function(scope,element,attr,ctrl){scope.$watch("trigger",function(value){value===!0&&$timeout(function(){var ele=element[0];ele.selectionStart=ele.value.length,ele.focus(),scope.trigger=!1},1e3)})}}}).directive("verticalSpace",function($log){return $log.warn("vertical-space is now deprecated. Use st-vertical-space instead."),{restrict:"E",replace:!0,template:'<div class="row"><div class="vertical-space"></div></div>'}}).directive("stValue",function(){return{restrict:"E",scope:{object:"=",attr:"=",value:"="},link:function($scope){$scope.object||($scope.object={}),$scope.object[$scope.attr]=$scope.value,$scope.$watch($scope.value,function(){$scope.object[$scope.attr]=$scope.value})}}}).directive("usuarioSistema",function($mdDialog,stService,stUtil,loginUtil){return{restrict:"E",templateUrl:"global/st-api/st-util/template-module/usuario-sistema/usuarioSistema.html",controller:function($scope,$rootScope,$cookieStore,filialUtil){$rootScope.$watch("usuarioSistema",function(usuarioSistema){$scope.usuarioSistema=usuarioSistema}),$scope.logOut=function(){loginUtil.logOut()},$scope.editarFilial=function(){filialUtil.openDetalheCurrentFilial(function(filial){})},$scope.editarUsuario=function(usuarioSistema){$mdDialog.show({animation:!0,templateUrl:"global/st-api/st-util/template-module/usuario-sistema/modalEditUsuario.html",size:"lg",controller:function($scope){$scope.usuarioSistema=usuarioSistema,$scope.salvar=function(usuarioSistema,modal){return usuarioSistema.senha?usuarioSistema.senha!=usuarioSistema.senha2?void stUtil.showMessage("","As senhas não conferem!","danger"):usuarioSistema.senha.length<6?void stUtil.showMessage("","A senha deve ter pelo menos 6 caracteres.","danger"):void stService.save("operadorsistema",usuarioSistema).then(function(){stUtil.showMessage("","Salvo com sucesso!","info"),modal.$dismiss("cancel")}):void stUtil.showMessage("","O campo senha deve ser preenchido!","danger")},$scope.fechar=function(ele){ele.$dismiss("cancel"),callback($scope.objeto)}}})}}}}).directive("stToggle",function(){return{restrict:"E",templateUrl:"global/st-api/st-util/template-module/stToggle.html",scope:{ngModel:"=",ngDisabled:"="}}}).directive("stSplitCheck",function(){return{restrict:"E",templateUrl:"global/st-api/st-util/template-module/st-split-check.html",scope:{ngModel:"=",preValues:"=",limiteLabel:"="},controller:function($scope){null==$scope.ngModel&&($scope.ngModel="");var its=$scope.preValues.split(","),itens=[];for(var i in its){var sele=-1!=$scope.ngModel.indexOf(its[i]);itens.push({label:its[i],selecionado:sele})}$scope.itens=itens,$scope.changeCheck=function(){var model="";for(var j in $scope.itens)1==$scope.itens[j].selecionado&&(model=model+","+$scope.itens[j].label);$scope.ngModel=model}}}}).directive("stStep",function(){return{restrict:"E",templateUrl:"global/st-api/st-util/template-module/st-step.html",scope:{steps:"=",step:"=",initialStep:"="},controller:function($scope){$scope.initialStep||($scope.step=0),$scope.changeStep=function(index){$scope.step=index}}}}).directive("inputEdit",function(){return{restrict:"E",templateUrl:"global/st-api/st-util/template-module/inputEdit.html",transclude:!0,scope:{label:"=",ngModel:"=",icon:"=",type:"="},controller:function($scope){$scope.ngModel?$scope.mostraValor=!0:$scope.mostraValor=!1}}}).directive("stCollapse",function(){return{restrict:"E",templateUrl:"global/st-api/st-util/template-module/st-collapse.html",transclude:!0,scope:{label:"="},controller:function($scope){$scope.show=!1}}}).directive("stPeriod",function(dateUtil,$localStorage){return{restrict:"E",templateUrl:"global/st-api/st-util/template-module/stPeriod.html",require:["de","ate","submit"],scope:{de:"=",ate:"=",submit:"=",change:"=",syncPeriod:"="},controller:function($scope){1==$scope.syncPeriod&&($scope.de=$localStorage.dataDe,$scope.ate=$localStorage.dataAte,$scope.$watch("de",function(de){$localStorage.dataDe=de}),$scope.$watch("ate",function(ate){$localStorage.dataAte=ate})),$scope.alterarPeriodo=function(periodo){var p=dateUtil.getPeriodOf(periodo);$scope.de=p.de,$scope.ate=p.ate}}}}).directive("stAlertButton",function(){return{restrict:"E",templateUrl:"global/st-api/st-util/template-module/stAlertButton.html",controller:function($scope,$interval,stService,$mdDialog,$location,$stDetalhe,$route){var getAlerts=function(){stService.executeGet("projecao/execute-query",{query:"select p.id,p.nome,'',p.quantidade from Produto p where (p.quantidade<=p.minQuant) and p.disable =0"}).then(function(data){$scope.itens=data.itens,$scope.numAlerts=data.itens.length})["catch"](function(){})};$interval(getAlerts,15e3),$scope.openAlerts=function(itens){$mdDialog.show({animation:!0,templateUrl:"global/st-api/st-util/template-module/modalAlertEstoque.html",size:"md",controller:function($scope){$scope.itens=itens,$scope.fechar=function(ele){ele.$dismiss("cancel"),callback($scope.objeto)},$scope.toProduct=function(idProduto,modal){modal.$dismiss("cancel"),stService.getById("produto",idProduto).then(function(data){$stDetalhe.open("view/produto/addAndUpdateProduto.html",data.item,$scope,function(res){$route.reload()})})}}})}}}})}(),function(){angular.module("stapi").directive("mobileTabs",function(onlineStatus){return{restrict:"E",templateUrl:"global/st-api/st-util/template-module/mobileTabs.html",scope:{activeTab:"=",tabs:"=",disableFixToBotton:"="},controllerAs:"vm",bindToController:!0,controller:function(){var vm=this;0!=vm.activeTab&&(vm.activeTab=vm.activeTab||1),vm.alterarTab=function(tab){vm.activeTab=tab}}}})}(),function(){angular.module("stapi").directive("stSelect",function(stService){return{restrict:"E",templateUrl:"global/st-api/st-util/template-module/stSelect.html",scope:{urlBase:"=",attrLabel:"=",ngModel:"="},controller:function($scope){stService.getAll($scope.urlBase).then(function(data){$scope.itens=data.itens})}}})}(),function(){angular.module("stapi").controller("estadosCidadesController",function(stService,stUtil){var vm=this;vm.loadingEstados=!0,stService.executeGet("estadoscidades/get-estados").then(function(data){if(vm.loadingEstados=!1,vm.estados=data.itens,vm.uf){var index=stUtil.buscaOb(vm.estados,vm.uf,"uf");vm.estado=vm.estados[index],vm.changeEstado({uf:vm.uf})}}),vm.changeCidade=function(cidade){vm.uf=cidade.uf,vm.codigoMunicipio=cidade.codigoMunicipio,vm.nomeMunicipio=cidade.nome,vm.codigoUf=vm.estado.codigoUf},vm.changeEstado=function(estado){vm.loadingCidades=!0,stService.executeGet("estadoscidades/get-cidades",{uf:estado.uf}).then(function(data){vm.loadingCidades=!1,vm.cidades=data.itens})},vm.codigoMunicipio&&(vm.loading=!0,stService.executeGet("/estadoscidades/get-cidade",{codMun:vm.codigoMunicipio}).then(function(data){vm.cidade=data.item,vm.loading=!1}))})}(),function(){function getDirectiveDefinition(tipoInput){var stInput=function($compile,dateUtil,$filter){return{restrict:"E",templateUrl:"global/st-api/st-input/html/stInput.html",require:"ngModel",scope:{ngModel:"="},link:function(scope,ele,attrs,ctrl){var labelElement=ele.find("label"),inputElement=ele.find("input").clone();labelElement.on("click",function(){inputElement.focus()}),inputElement.attr("type",attrs.type),"int"==tipoInput?inputElement.attr("type","tel"):"double"==tipoInput?(inputElement.attr("ui-number-mask",2),inputElement.attr("type","tel")):"date"==tipoInput&&inputElement.attr("st-date-picker",""),inputElement=$compile(inputElement)(scope),ele.find("input").replaceWith(inputElement),scope.label=attrs.label,scope.icon=attrs.icon}}};return stInput}function stInputCheck(){return{templateUrl:"global/st-api/st-input/html/stInputCheck.html"}}function stDatePicker($compile,$filter,stService,$rootScope,stUtil,dateUtil){return{require:"ngModel",scope:{},link:function($scope,element,attrs,ctrl){element.datepicker({dateFormat:"dd/mm/yy","z-index":9999,onSelect:function(date){ctrl.$setViewValue(dateUtil.formatDate(date)),$scope.$apply()}}),ctrl.$formatters.push(function(value){return value=angular.copy(value),value=$filter("date")(value,"dd/MM/yyyy"),console.log("Filtered: "),console.log(value),value})}}}function inputClear(){return{restrict:"A",compile:function(element,attrs){var color=attrs.inputClear,style=color?"color:"+color+";":"",action=attrs.ngModel+" = ''";element.after('<md-button class="animate-show md-icon-button md-accent"ng-show="'+attrs.ngModel+'" ng-click="'+action+'"style="position: absolute; top: 0px; right: -6px;"><div style="'+style+'">x</div></md-button>');
}}}angular.module("stapi").directive("inputClear",inputClear).directive("stDatePicker",stDatePicker).directive("stInputCheck",stInputCheck).directive("inputCheck",stInputCheck).directive("stInputDate",getDirectiveDefinition("date")).directive("inputDate",getDirectiveDefinition("date")).directive("stInput",getDirectiveDefinition("string")).directive("stInputString",getDirectiveDefinition("string")).directive("inputString",getDirectiveDefinition("string")).directive("stInputDouble",getDirectiveDefinition("double")).directive("inputDouble",getDirectiveDefinition("double")).directive("stInputInt",getDirectiveDefinition("int")).directive("inputInt",getDirectiveDefinition("int"))}(),function(){function stInputUtil($http,config,$cookieStore){var _transformGenericQuerys=function(qs){for(var i in qs)if(_isGenericQuery(qs[i])){qs[i]=qs[i].trim();var attr=qs[i].substring(qs[i].indexOf("_"),qs[i].indexOf(".")).replace("_",""),subAttr=qs[i].substring(qs[i].indexOf("."),qs[i].indexOf(" ")).replace(".",""),restoQuery=qs[i].substring(qs[i].indexOf(subAttr)).replace(subAttr,""),queryTransformed="_"+attr+"['"+subAttr+"']"+restoQuery;qs[i]=queryTransformed}return qs},_isGenericQuery=function(q){return-1!=q.indexOf("_string.")||-1!=q.indexOf("_int.")||-1!=q.indexOf("_double.")||-1!=q.indexOf("_date.")};return{isGenericQuery:_isGenericQuery,transformGenericQuerys:_transformGenericQuerys}}angular.module("stapi").factory("genericUtil",stInputUtil).factory("stInputUtil",stInputUtil)}(),function(){angular.module("stapi").controller("stCheckListController",function($scope,stUtil,$filter,stService,$mdDialog){function hasFixProperties(ob){ob=angular.copy(ob);var fixProperties=ctrl.crudOptions.fixProperties,has=!0;for(var key in fixProperties)ob[key]==fixProperties[key]||(has=!1);return has}function reorderItems(){var objectName=ctrl.crudOptions.objectName,lista=ctrl.objetos,obj={};obj.objectName=objectName,obj.items=[];for(var i in lista)lista[i].orderIndex=i+"",obj.items.push({id:lista[i].id,orderIndex:i+""});stService.executePost("/reorder-items/",obj)}function setFixProperties(ob){var fixProperties=ctrl.crudOptions.fixProperties;if(fixProperties)for(var key in fixProperties)ob[key]=fixProperties[key],stUtil.setValueOfNivel(ob,key,fixProperties[key]);return ob}function getNextOrderIndex(){return 0==ctrl.objetos.length?0:ctrl.objetos.length}function init(){if(ctrl.trueValue=ctrl.trueValue||"'true'",ctrl.falseValue=ctrl.falseValue||"'false'",ctrl.crudOptions){var qs=[];qs=qs.concat(stUtil.transformJSONToSqlComparators(ctrl.crudOptions.fixProperties)),stService.getList({objectName:ctrl.crudOptions.objectName,querys:qs}).then(function(data){ctrl.objetos=data.itens||[],resolveInitialOrderForObs(ctrl.objetos)})}else ctrl.objetos=ctrl.objetos||[],resolveInitialOrderForObs(ctrl.objetos)}function resolveInitialOrderForObs(obs){var orderBy=ctrl.orderBy||"orderIndex";for(var i in obs){var order=obs[i][orderBy];0==order||order||(order=i),obs[i][orderBy]=order}return obs.sort(function(a,b){return a[orderBy]-b[orderBy]}),obs}var ctrl=this;ctrl.scope=$scope,init(),$scope.$watch("vm.objetos",function(newValue,oldValue){if(newValue.length>oldValue.length)for(var i=0;i<newValue.length;i++)if(!angular.equals(newValue[i],oldValue[i])){var changedItem=newValue[i];0==hasFixProperties(changedItem)&&(changedItem=setFixProperties(changedItem),stService.save(ctrl.crudOptions.objectName,changedItem).then(function(data){}))}},!0),ctrl.deleteAll=function(){var ids=[];ctrl.objetos.filter(function(item){ids.push(item.id)}),stService["delete"](ctrl.crudOptions.objectName,ids).then(function(){stUtil.showMessage("","Itens deletados com sucesso!"),init()})},ctrl.dragEnd=function(){reorderItems()},ctrl.changeChecked=function(item){stService.changeAttrValue(ctrl.crudOptions.objectName,item.id,ctrl.attr,item[ctrl.attr])},ctrl.editItem=function($event,item,index){var initalValue=stUtil.getValue(item,ctrl.attrLabel),confirm=$mdDialog.prompt().title("").textContent("").placeholder("").ariaLabel("").initialValue(initalValue).targetEvent($event).required(!0).multiple(!0).ok("OK").cancel("Cancelar");$mdDialog.show(confirm).then(function(value){stUtil.setValueOfNivel(item,ctrl.attrLabel,value),stService.changeAttrValue(ctrl.crudOptions.objectName,item.id,ctrl.attrLabel,value)},function(){})},ctrl.addItem=function(labelValue){var ob=stUtil.setValueOfNivel({},ctrl.attrLabel,labelValue),orderBy=ctrl.orderBy||"orderIndex";ob[orderBy]=getNextOrderIndex(),ctrl.newItem="",ob=setFixProperties(ob),stService.save(ctrl.crudOptions.objectName,ob).then(function(data){ctrl.objetos.push(data.item)})},ctrl.openDetail=function(item){ctrl.crudOptions&&ctrl.crudOptions.openDetail&&ctrl.crudOptions.openDetail(item)},ctrl.openMenu=function($event,$mdMenu){$event.stopPropagation(),$mdMenu.open()},ctrl.deleteFunction=function(item,index){ctrl.objetos.splice(index,1),reorderItems(),stService["delete"](ctrl.crudOptions.objectName,[item.id])}})}(),function(){angular.module("stapi").directive("stCheckList",function(stUtil){return{templateUrl:function(element,attrs){return attrs.type?"global/st-api/st-check-list/html/"+attrs.type+".html":"global/st-api/st-check-list/html/stCheckList.html"},scope:{crudOptions:"<",showBorderNoItems:"<",hideAdd:"<",hideCheckbox:"<",hideDeleteAll:"<",objetos:"=?",attrLabel:"@",attr:"@",trueValue:"@",falseValue:"@",showCrudTools:"<"},restrict:"E",bindToController:!0,controllerAs:"vm",controller:"stCheckListController"}})}(),function(){function stBreadcumb(configUtil,stService,$rootScope,$route,$filter,stUtil){return{restrict:"E",templateUrl:"global/st-api/st-breadcumb/html/stBreadcumb.html",controllerAs:"$stBreadcumbCtrl",bindController:!0,controller:function($scope,$controller,stMenuUtil){var ctrl=this;ctrl.scope=$scope,ctrl.data={},ctrl.data.changePath=function(path){stMenuUtil.changePath(path)}}}}angular.module("stapi").directive("breadcumb",stBreadcumb).directive("stBreadcumb",stBreadcumb)}(),function(){function stMenuController($scope,$rootScope,$timeout,$route,loginUtil,$location,stUtil,config,$mdSidenav,menuItems,sidenavId,stMenuUtil){function changePath(path){$timeout($mdSidenav(ctrl.data.sidenavId).close,500),stMenuUtil.changePath(path)}function toggleSideNav(){$mdSidenav(ctrl.data.sidenavId).toggle()}function logOut(){$timeout($mdSidenav(ctrl.data.sidenavId).close,500),loginUtil.logOut()}var ctrl=this;ctrl.data={},ctrl.data.toggleSideNav=toggleSideNav,ctrl.data.logOut=logOut,ctrl.data.changePath=changePath,ctrl.data.menuItems=menuItems,ctrl.data.sidenavId=sidenavId,$rootScope.menuItems=menuItems,$rootScope.$on("$routeChangeSuccess",function(){var path;return $route.current?(path=$route.current.$$route.originalPath,config.confs.pathsToHideMenu&&-1!=config.confs.pathsToHideMenu.indexOf(path)?ctrl.data.showMenu=!1:ctrl.data.showMenu=!0,void(path!=config.confs.loginPath&&changePath(path))):void $location.path(config.confs.notFoundPath||"inicio")})}angular.module("stapi").controller("stMenuController",stMenuController)}(),function(){angular.module("stapi").config(function(){})}(),function(){angular.module("stapi").factory("stMenuUtil",function($rootScope,$filter,stUtil,$location){var _changePath=function(path){var item,menuItems=$rootScope.menuItems;if("string"==typeof path){path=path.replace("/","");var indexItem=stUtil.buscaOb(menuItems,path,"path");item=menuItems[indexItem]||{}}else item=path;$rootScope.currentPathIcon=item.icon,$rootScope.currentPathLabel=item.label,$rootScope.currentPath=item.path,document.title=item.label||"",$rootScope.routeHistory=$rootScope.routeHistory||[];var routeHistory=$rootScope.routeHistory,indexHistory=stUtil.buscaOb(routeHistory,item.label,"label");-1!=indexHistory&&routeHistory.splice(indexHistory,1),$rootScope.routeHistory.push(item),$location.path(item.path)},_startOnboard=function(scope){};return{startOnboard:_startOnboard,changePath:_changePath}})}(),function(){function genericDetalheController($scope,stService,functionToDetailNotify,objectName,stCrudTools,$mdDialog,item){function cancelFunction(){$mdDialog.cancel()}function deleteFunction(item){ctrl.data.loading=!0;var options={objectName:objectName,item:item,$mdDialog:$mdDialog,functionToNotify:functionToDetailNotify};stCrudTools.deleteAndNotify(options).then(function(){ctrl.data.loading=!1})["catch"](function(){ctrl.data.loading=!1})}function saveFunction(item){ctrl.data.loading=!0;var options={objectName:objectName,item:item,$mdDialog:$mdDialog,functionToNotify:functionToDetailNotify};stCrudTools.saveAndNotify(options).then(function(data){ctrl.data.loading=!1,ctrl.data.item.id=data.item.id})["catch"](function(){ctrl.data.loading=!1})}var ctrl=this;ctrl.data={},ctrl.data.item=item,ctrl.scope=$scope,ctrl.data.loading=!1,ctrl.data.cancelFunction=cancelFunction,ctrl.data.deleteFunction=deleteFunction,ctrl.data.saveFunction=saveFunction}function genericListControl($scope,filtros,$route,$mdMedia,$mdDialog,options,config,$q,stService,stUtil,$mdEditDialog,stCrudTools,$log){function filialChangeStart(){}function filialChangeSuccess(){getList()}function filialChangeError(){}function cancelResolve(obj){}function saveSuccessResolve(obj){stUtil.showMessage("","Salvo com sucesso!"),obj.$mdDialog.hide(),obj.itemAnt.id?ctrl.data.getList():$route.reload()}function saveErrorResolve(obj){stUtil.showMessage("","Ocorreu um erro ao salvar o item","danger")}function deleteSuccessResolve(obj){stUtil.showMessage("","Item deletado com sucesso"),obj.$mdDialog.hide(),ctrl.data.getList()}function deleteErrorResolve(obj){stUtil.showMessage("","Ocorreu um erro ao deletar o item","danger")}function resolveDetalheNotify(obj){obj.event==stCrudTools.CANCEL?ctrl.data.cancelResolve(obj):obj.event==stCrudTools.SAVE_SUCCESS?ctrl.data.saveSuccesResolve(obj):obj.event==stCrudTools.SAVE_ERROR?ctrl.data.saveErrorResolve(obj):obj.event==stCrudTools.DELETE_SUCCESS?ctrl.data.deleteSuccessResolve(obj):obj.event==stCrudTools.DELETE_ERROR&&ctrl.data.deleteErrorResolve(obj)}function getSelectedItemsIds(){var ids=[];return ctrl.data.selectedItems.filter(function(item){ids.push(item.id)}),ids}function showMdMenu($mdMenu,ev){$mdMenu.open(ev)}function editColumn(event,options){event.stopPropagation();var editDialog={modelValue:stUtil.getValue(options.item,options.column),placeholder:options.placeholder,save:function(input){stUtil.setValue(options.item,options.column,input.$modelValue),changeAttrValue(options.item.id,options.column,input.$modelValue)},targetEvent:event,title:options.title||"",validators:options.validators||{}};return $mdEditDialog.small(editDialog)}function changeAttrValue(idItem,column,value){stService.changeAttrValue(objectName,idItem,column,value)}function saveFunction(_item){stService.save(objectName,_item).then(function(){})}function deleteFunction(ids){stService["delete"](objectName,ids).then(function(){stUtil.showMessage("","Os itens foram deletados com sucesso!"),getList()})["catch"](function(){stUtil.showMessage("","Ocorreu um erro ao deletar os itens!","md-error")})}function openDetail(item,parent){"number"==typeof item?stService.getById(objectName,item).then(function(data){var item=setFixPropertiesToItem(data.item);showDetailDialog(item,parent)})["catch"](function(){stUtil.showMessage("","Ocorreu um erro ao recuperar o item","danger")}):(item=item||{},item=angular.copy(item),item=setFixPropertiesToItem(item),showDetailDialog(item,parent))}function setFixPropertiesToItem(item){var fix=fixProperties||{};for(var key in fix)item=stUtil.setValueOfNivel(item,key,fix[key]);return item}function showDetailDialog(item,parent){$mdMedia("sm")||$mdMedia("xs");$mdDialog.show({controllerAs:detalheControllerAs,controller:detalheController,resolve:{item:function(){return item},objectName:function(){return objectName},functionToDetailNotify:function(){return ctrl.data.resolveDetalheNotify}},templateUrl:detalheTemplateUrl,parent:parent||angular.element(document.body),clickOutsideToClose:!1,multiple:!0,fullscreen:config.fullScreenItemDetail||!0,autoWrap:!0}).then(function(res){},function(){stCrudTools.cancelAndNotify(ctrl.data.resolveDetalheNotify)})}function getList(){var deferred=$q.defer();ctrl.data.loading=!0,ctrl.data.requestListParams.querys=ctrl.data.requestListParams.querys||[];var fixQuerysAndFixProperties=[];fixQuerysAndFixProperties=fixQuerysAndFixProperties.concat(stUtil.transformJSONToSqlComparators(fixProperties)),fixQuerysAndFixProperties=fixQuerysAndFixProperties.concat(fixQuerys);var paramOptions=angular.copy(ctrl.data.requestListParams);return paramOptions.querys=paramOptions.querys||[],paramOptions.querys=paramOptions.querys.concat(fixQuerysAndFixProperties),stService.getList(paramOptions).then(function(data){return 0!=ctrl.data.requestListParams.pagina&&0==data.itens.length?(ctrl.data.requestListParams.pagina=0,void getList()):(ctrl.data.loading=!1,deferred.resolve(data),ctrl.data.totalItens=data.countAll,ctrl.data.objetos=data.itens,void(ctrl.data.selectedItems=[]))})["catch"](function(){ctrl.data.loading=!1,deferred.reject()}),deferred.promise}var ctrl=this,objectName=options.objectName,detalheTemplateUrl=options.detalheTemplateUrl,detalheController=options.detalheController,detalheControllerAs=options.detalheControllerAs,fixProperties=options.fixProperties||{},fixQuerys=options.fixQuerys||[];ctrl.scope=$scope,$scope.$on("filialChangeStart",function(evt,current,next){}),$scope.$on("filialChangeSuccess",function(evt,current,previous){ctrl.data.filialChangeSuccess()}),$scope.$on("filialChangeError",function(evt,current,next){}),ctrl.data={},ctrl.data.objectName=objectName,ctrl.data.filtros=filtros,ctrl.data.selectedItems=[],ctrl.showMdMenu=showMdMenu,ctrl.data.getSelectedItemsIds=getSelectedItemsIds,ctrl.data.resolveDetalheNotify=resolveDetalheNotify,ctrl.data.getList=getList,ctrl.data.saveFunction=saveFunction,ctrl.data.openDetail=openDetail,ctrl.data.deleteFunction=deleteFunction,ctrl.data.editColumn=editColumn,ctrl.data.changeAttrValue=changeAttrValue,ctrl.data.saveSuccesResolve=saveSuccessResolve,ctrl.data.saveErrorResolve=saveErrorResolve,ctrl.data.deleteSuccessResolve=deleteSuccessResolve,ctrl.data.deleteErrorResolve=deleteErrorResolve,ctrl.data.cancelResolve=cancelResolve,ctrl.data.filialChangeStart=filialChangeStart,ctrl.data.filialChangeSuccess=filialChangeSuccess,ctrl.data.filialChangeError=filialChangeError}function genericListController($scope,filtros,$route,$mdMedia,$mdDialog,objectName,detalheTemplateUrl,detalheController,detalheControllerAs,config,$q,stService,stUtil,$mdEditDialog,stCrudTools,$log){function filialChangeStart(){}function filialChangeSuccess(){getList()}function filialChangeError(){}function cancelResolve(obj){}function saveSuccessResolve(obj){stUtil.showMessage("","Salvo com sucesso!"),obj.$mdDialog.hide(),obj.itemAnt.id?ctrl.data.getList():$route.reload()}function saveErrorResolve(obj){stUtil.showMessage("","Ocorreu um erro ao salvar o item","danger")}function deleteSuccessResolve(obj){stUtil.showMessage("","Item deletado com sucesso"),obj.$mdDialog.hide(),ctrl.data.getList()}function deleteErrorResolve(obj){stUtil.showMessage("","Ocorreu um erro ao deletar o item","danger")}function resolveDetalheNotify(obj){obj.event==stCrudTools.CANCEL?ctrl.data.cancelResolve(obj):obj.event==stCrudTools.SAVE_SUCCESS?ctrl.data.saveSuccesResolve(obj):obj.event==stCrudTools.SAVE_ERROR?ctrl.data.saveErrorResolve(obj):obj.event==stCrudTools.DELETE_SUCCESS?ctrl.data.deleteSuccessResolve(obj):obj.event==stCrudTools.DELETE_ERROR&&ctrl.data.deleteErrorResolve(obj)}function getSelectedItemsIds(){var ids=[];return ctrl.data.selectedItems.filter(function(item){ids.push(item.id)}),ids}function showMdMenu($mdMenu,ev){$mdMenu.open(ev)}function editColumn(event,options){event.stopPropagation();var editDialog={modelValue:stUtil.getValue(options.item,options.column),placeholder:options.placeholder,save:function(input){stUtil.setValue(options.item,options.column,input.$modelValue),changeAttrValue(options.item.id,options.column,input.$modelValue)},targetEvent:event,title:options.title||"",validators:options.validators||{}};return $mdEditDialog.small(editDialog)}function changeAttrValue(idItem,column,value){stService.changeAttrValue(objectName,idItem,column,value)}function saveFunction(_item){stService.save(objectName,_item).then(function(){})}function deleteFunction(ids){stService["delete"](objectName,ids).then(function(){stUtil.showMessage("","Os itens foram deletados com sucesso!"),getList()})["catch"](function(){stUtil.showMessage("","Ocorreu um erro ao deletar os itens!","md-error")})}function openDetail(item,parent){"number"==typeof item?stService.getById(objectName,item).then(function(data){var item=data.item;showDetailDialog(item,parent)})["catch"](function(){stUtil.showMessage("","Ocorreu um erro ao recuperar o item","danger")}):(item=item||{},item=angular.copy(item),showDetailDialog(item,parent))}function showDetailDialog(item,parent){$mdMedia("sm")||$mdMedia("xs");$mdDialog.show({controllerAs:detalheControllerAs,controller:detalheController,resolve:{item:function(){return item},objectName:function(){return objectName},functionToDetailNotify:function(){return ctrl.data.resolveDetalheNotify}},templateUrl:detalheTemplateUrl,parent:parent||angular.element(document.body),clickOutsideToClose:!1,multiple:!0,fullscreen:config.fullScreenItemDetail||!0,autoWrap:!0}).then(function(res){},function(){stCrudTools.cancelAndNotify(ctrl.data.resolveDetalheNotify)})}function getList(){var deferred=$q.defer();return ctrl.data.loading=!0,ctrl.data.requestListParams.querys=ctrl.data.requestListParams.querys||[],stService.getList(ctrl.data.requestListParams).then(function(data){return 0!=ctrl.data.requestListParams.pagina&&0==data.itens.length?(ctrl.data.requestListParams.pagina=0,void getList()):(ctrl.data.loading=!1,deferred.resolve(data),ctrl.data.totalItens=data.countAll,ctrl.data.objetos=data.itens,void(ctrl.data.selectedItems=[]))})["catch"](function(){ctrl.data.loading=!1,deferred.reject()}),deferred.promise}var ctrl=this;$log.warn("genericListController is now deprecated use genericListControl instead"),ctrl.scope=$scope,$scope.$on("filialChangeStart",function(evt,current,next){}),$scope.$on("filialChangeSuccess",function(evt,current,previous){ctrl.data.filialChangeSuccess()}),$scope.$on("filialChangeError",function(evt,current,next){}),ctrl.data={},ctrl.data.objectName=objectName,ctrl.data.filtros=filtros,ctrl.data.selectedItems=[],ctrl.showMdMenu=showMdMenu,ctrl.data.getSelectedItemsIds=getSelectedItemsIds,ctrl.data.resolveDetalheNotify=resolveDetalheNotify,ctrl.data.getList=getList,ctrl.data.saveFunction=saveFunction,ctrl.data.openDetail=openDetail,ctrl.data.deleteFunction=deleteFunction,ctrl.data.editColumn=editColumn,ctrl.data.changeAttrValue=changeAttrValue,ctrl.data.saveSuccesResolve=saveSuccessResolve,ctrl.data.saveErrorResolve=saveErrorResolve,ctrl.data.deleteSuccessResolve=deleteSuccessResolve,ctrl.data.deleteErrorResolve=deleteErrorResolve,ctrl.data.cancelResolve=cancelResolve,ctrl.data.filialChangeStart=filialChangeStart,ctrl.data.filialChangeSuccess=filialChangeSuccess,ctrl.data.filialChangeError=filialChangeError}angular.module("stapi").controller("genericListController",genericListController).controller("genericListControl",genericListControl).controller("genericDetalheController",genericDetalheController)}(),function(){function stService($http,config,$cookieStore,genericUtil,$location,$window,$q){var _getBaseUrl=function(){var pathApp=config.confs.path,base=new $window.URL($location.absUrl()).origin+"/";return-1!=$location.absUrl().indexOf(pathApp)&&(base+=pathApp+"/"),base},_getPromise=function(obRequest){var deferred=$q.defer();return obRequest.then(function(res){var data=res.data||{};data.status=res.status,data.response=res,deferred.resolve(res.data)},function(response){deferred.reject(response)}),deferred.promise},_executeSQLQuery=function(query){var req={method:"GET",params:{query:query}},obRequest=$http.get(_getBaseUrl()+"/projecao/execute-sql-query",req);return _getPromise(obRequest)},_executeQuery=function(query){var req={method:"GET",params:{query:query}},obRequest=$http.get(_getBaseUrl()+"/projecao/execute-query",req);return _getPromise(obRequest)},_save=function(nomeObjeto,objeto){var obRequest=$http.post(_getBaseUrl()+nomeObjeto.toLowerCase()+"/add/",objeto);return _getPromise(obRequest)},_delete=function(nomeObjeto,ids){var obRequest=$http.post(_getBaseUrl()+nomeObjeto.toLowerCase()+"/delete/",ids);return _getPromise(obRequest)},_getById=function(nomeObjeto,id){var req={method:"GET",params:{id:id}},obRequest=$http.get(_getBaseUrl()+nomeObjeto.toLowerCase()+"/get",req);return _getPromise(obRequest)},_getLike=function(nomeObjeto,queryBusca,prop){var req={method:"GET",params:{query:queryBusca,propriedade:prop}},obRequest=$http.get(_getBaseUrl()+nomeObjeto+"/busca/",req);return _getPromise(obRequest)},_getLikeMap=function(nomeObjeto,qs,pagina,max,extra){qs=genericUtil.transformGenericQuerys(qs);var req={method:"GET",params:{qs:qs,pagina:pagina,max:max,extra:extra}},obRequest=$http.get(_getBaseUrl()+nomeObjeto+"/busca/map",req);return _getPromise(obRequest)},_getList=function(queryOptions){queryOptions.querys&&0!=queryOptions.querys.length||(queryOptions.querys=[""]),queryOptions.pagina=queryOptions.pagina||0,queryOptions.extra=queryOptions.extra||"",queryOptions.maxItensPerPage=queryOptions.maxItensPerPage||0,queryOptions.objectName=queryOptions.objectName||queryOptions.nomeObjeto;var qs=genericUtil.transformGenericQuerys(queryOptions.querys);console.log("Querys transformadas: "),console.log(qs);var req={method:"GET",params:{qs:queryOptions.querys,pagina:queryOptions.pagina,max:queryOptions.maxItensPerPage,extra:queryOptions.extra}},obRequest=$http.get(_getBaseUrl()+queryOptions.objectName.toLowerCase()+"/busca/map",req);return _getPromise(obRequest)},_getAll=function(nomeObjeto){var req={method:"GET"},obRequest=$http.get(_getBaseUrl()+nomeObjeto,req);return _getPromise(obRequest)},_getValues=function(nomeOb,attr,extras){var req={method:"GET",params:{nomeOb:nomeOb,attr:attr,extras:extras||[""]}},obRequest=$http.get(_getBaseUrl()+"opcao/get-values",req);return _getPromise(obRequest)},_apagar=function(nomeObjeto,ids){var obRequest=$http.post(_getBaseUrl()+nomeObjeto+"/delete/",ids);return _getPromise(obRequest)},_executePost=function(url,objeto){var obRequest=$http.post(_getBaseUrl()+url,objeto);return _getPromise(obRequest)},_executeGet=function(url,params){var req={method:"GET",params:params},obRequest=$http.get(_getBaseUrl()+url,req);return _getPromise(obRequest)},_getProjecoesFromObject=function(objeto,ops){ops.extra=ops.extra||"",ops.qs=ops.qs||[""],ops.max=ops.max||0,ops.qs=genericUtil.transformGenericQuerys(ops.qs);var req={method:"GET",params:ops},obRequest=$http.get(_getBaseUrl()+objeto+"/projecoes",req);return _getPromise(obRequest)},_getProjecoes=function(ops){ops.extra=ops.extra||"",ops.qs=ops.qs||[""],ops.max=ops.max||0,ops.qs=genericUtil.transformGenericQuerys(ops.qs);var obRequest=$http.post(_getBaseUrl()+"projecao/get-projecoes/",ops);return _getPromise(obRequest)},_changeAttrValue=function(objeto,id,key,value){value="'"+value+"'";var req={method:"GET",params:{id:id,key:key,value:value}},obRequest=$http.get(_getBaseUrl()+objeto.toLowerCase()+"/change-attr-value",req);return _getPromise(obRequest)};return{getLikeMap:_getLikeMap,getLike:_getLike,getAll:_getAll,save:_save,"delete":_delete,getById:_getById,getProjecoes:_getProjecoes,getProjecoesFromObject:_getProjecoesFromObject,getValues:_getValues,apagar:_apagar,executePost:_executePost,executeGet:_executeGet,executeQuery:_executeQuery,executeSQLQuery:_executeSQLQuery,getBaseUrl:_getBaseUrl,getList:_getList,changeAttrValue:_changeAttrValue}}angular.module("stapi").factory("stService",stService)}(),function(){function loginUtil(cacheGet,$localStorage,$rootScope,$cookieStore,stService,filialUtil,$location,dateUtil,$mdDialog,st,config){var _openLembrarSenha=function(){$mdDialog.show({animation:!0,templateUrl:"global/st-api/app-login/template-module/modalLembrarSenha.html",size:"lg",bindToController:"true",controllerAs:"vm",controller:function(stService,stUtil,$modalInstance){var vm=this;vm.step=1,vm.numero=$localStorage.usuario,vm.fechar=function(){$modalInstance.close()},vm.lembrarSenha=function(_numero){stService.executeGet("/lembrar-senha-sms",{numero:_numero}).then(function(res){1==res?vm.step=2:stUtil.showMessage("","Usuário inexistente no sistema","danger")})}}})},_logOut=function(){delete $rootScope.currentFilial,delete $rootScope.user,delete $rootScope.authToken,delete $rootScope.usuarioSistema,delete $localStorage.senha,$cookieStore.remove("authToken"),$cookieStore.remove("usuarioSistema");var confs=config.confs||{};$location.path(confs.loginPath||"login")},_configureSystemForUser=function(loginData){var filiais=loginData.filiais;$rootScope.filiais=filiais;var authToken=loginData.token;$rootScope.authToken=authToken,$cookieStore.put("authToken",authToken);var usuarioSistema=loginData.usuarioSistema;usuarioSistema.originalLogin=usuarioSistema.login,usuarioSistema.login=usuarioSistema.login.split("@")[0],$rootScope.usuarioSistema=usuarioSistema,$rootScope.config=loginData.config;var tenantConfs=loginData.config.confs,staticConfs=config.confs;console.log("Configurações estáticas !!!!!!"),console.log(staticConfs);var confsToApply=staticConfs;for(var key in tenantConfs)confsToApply[key]=tenantConfs[key];config.confs=confsToApply,$cookieStore.put("usuarioSistema",usuarioSistema);var idFilialInConfig=parseInt($rootScope.config.confs.currentFilialId),filiaisPermitidas=[];if(usuarioSistema.filiaisPermitidas&&usuarioSistema.filiaisPermitidas.length>0&&(filiaisPermitidas=$rootScope.usuarioSistema.filiaisPermitidas.split(",")),idFilialInConfig>0&&(-1!=filiaisPermitidas.indexOf(idFilialInConfig+"")||0==filiaisPermitidas.length))$rootScope.currentFilial=filialUtil.getFilialById(idFilialInConfig);else{var filteredFiliais=filiais.filter(function(filial){return-1!=filiaisPermitidas.indexOf(filial.id+"")?filial:void 0});$rootScope.currentFilial=filteredFiliais[0]}$rootScope.currentFilial&&$rootScope.currentFilial.id||($rootScope.currentFilial={id:1,nome:"Matriz"})},_logar=function(login,lembrarSenha,callback){login.empresa||callback(),$localStorage.empresa=login.empresa,$localStorage.usuario=login.usuario,1==lembrarSenha?$localStorage.senha=login.senha:delete $localStorage.senha,$cookieStore.remove("authToken"),stService.executePost("/user/login/",login).then(function(data){var dataFrontEnd=dateUtil.getDate(new Date),dataBackEnd=dateUtil.getDate(data.dataBackEnd);dataFrontEnd.getTime()!=dataBackEnd.getTime()&&$mdDialog.show($mdDialog.alert().parent(angular.element(document.body)).clickOutsideToClose(!0).title("Data incorreta").htmlContent("<p>A data do seu dispositivo está incorreta. Isso pode ocasionar erros no uso do sistema.</p>").ok("OK")),_configureSystemForUser(data),callback(data)})["catch"](function(data,erro){callback()})},_isLogado=function(){return $rootScope.usuarioSistema?!0:!1};return{logar:_logar,logOut:_logOut,isLogado:_isLogado,openLembrarSenha:_openLembrarSenha}}angular.module("stapi").factory("loginUtil",loginUtil)}(),function(){function buttonFilialController($scope,$rootScope,$timeout,$localStorage,configUtil,cacheGet,stUtil){function changeFilial(filial){var previousFilial=ctrl.currentFilial;return $rootScope.$broadcast("filialChangeStart",ctrl.currentFilial,filial),1==filial.bloqueada?void stUtil.showMessage("","A origem '"+filial.nome+"' está bloqueada.","danger"):null!=$scope.filiaisPermitidas&&-1==$scope.filiaisPermitidas.indexOf(filial.id+"")?void stUtil.showMessage("","A origem '"+filial.nome+"' não está disponível para este usuário","danger"):($rootScope.currentFilial=filial,$localStorage.currentFilial=filial,stUtil.showMessage("","Origem alterada para  '"+filial.nome||filial.xNome+"'.","info"),void $rootScope.$broadcast("filialChangeSuccess",ctrl.currentFilial,previousFilial))}var ctrl=this;ctrl.scope=$scope,ctrl.changeFilial=changeFilial,$rootScope.$watch("currentFilial",function(currentFilial){currentFilial&&(ctrl.currentFilial=currentFilial)}),$rootScope.$watch("filiais",function(filiais){filiais&&(ctrl.filiais=filiais)})}angular.module("stapi").controller("buttonFilialCtrl",buttonFilialController)}(),function(){function filialUtil(stService,$rootScope,$localStorage,stUtil,st,$mdDialog,$http,config){var _openDetalheCurrentFilial=function(filial,callback){$mdDialog.show({animation:!0,templateUrl:"global/st-api/st-filial/html/modalDetalheFilial.html",size:"lg",controller:function($scope,$rootScope){$scope.filial=$rootScope.currentFilial,$scope.fechar=function(ele){ele.$dismiss("cancel"),callback($scope.filial)},$scope.enviarCertificado=function(file,senha){var fd=new FormData;fd.append("file",file),fd.append("senha",senha),$http.post(stService.getBaseUrl()+"filial/upload-certificado/",fd,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).then(function(data){$rootScope.currentFilial.nomeCertificado=data.item,$scope.filial.nomeCertificado=data.item})["catch"](function(){})},$scope.salvar=function(filial){stService.save("filial",filial).then(function(data){stUtil.showMessage("","Salvo com sucesso","info"),callback&&callback(data.item)})}}})},_getAllFiliais=function(callback){stService.getAll("filial").then(function(data){var filiais=data.itens;filiais.length>0?($rootScope.filiais=filiais,$rootScope.filiais.unshift({id:0,xNome:"Todas"}),$rootScope.currentFilial=$localStorage.currentFilial||data.itens[0]):($rootScope.filiais=[{id:1,xNome:"Matriz"}],$rootScope.currentFilial={id:1,xNome:"Matriz"}),callback&&callback(data.itens)})["catch"](function(){callback()})},_getFilialById=function(id){var filial={},index=stUtil.buscaOb($rootScope.filiais,id,"id");return-1!=index&&(filial=$rootScope.filiais[index]),filial};return{getFilialById:_getFilialById,getAllFiliais:_getAllFiliais,openDetalheCurrentFilial:_openDetalheCurrentFilial}}angular.module("stapi").factory("filialUtil",filialUtil)}(),function(){function buttonFilial(filialUtil,$mdDialog){return{templateUrl:"global/st-api/st-filial/html/buttonFilial.html",controllerAs:"$buttonFilialCtrl",bindToController:"true",controller:"buttonFilialCtrl"}}function alertFilial(filialUtil){return{templateUrl:"global/st-api/st-filial/html/alertFilial.html",scope:{label:"="},controller:function($scope,$rootScope){$scope.currentFilial=$rootScope.currentFilial}}}function setAllFilials(filialUtil){return{templateUrl:"global/st-api/st-filial/html/setAllFilials.html",scope:{objeto:"=",defaultValue:"="},controller:function($scope,$rootScope){"true"==$scope.defaultValue?$scope.defaultValue=!0:"false"==$scope.defaultValue&&($scope.defaultValue=!1),$scope.filiais=$rootScope.filiais,$scope.objeto||($scope.objeto={allFilials:!0}),$scope.objeto.id||($scope.objeto.allFilials=$scope.defaultValue||!1)}}}angular.module("stapi").directive("buttonFilial",buttonFilial).directive("alertFilial",alertFilial).directive("setAllFilials",setAllFilials)}(),function(){angular.module("stapi").controller("cadastrosController",function($scope,stService,$rootScope,stUtil,$filter,cadastrosUtil){$scope.apagar=function(op,index){stService.apagar("opcao",[op.id]).then(function(){$scope.opcoes.splice(index,1)})},$scope.openCadastro=function(cadastro){cadastrosUtil.openCadastro(cadastro,function(item){$scope.getOpcoes($scope.descricao,$scope.label)})},$scope.getOpcoes=function(descricao,label){$scope.label=label,$scope.descricao=descricao,stService.getLikeMap("opcao",["descricao='"+descricao+"'"],0,0,"").then(function(data){$scope.opcoes=data.itens})}})}(),function(){angular.module("stapi").config(function($routeProvider,$httpProvider){$routeProvider.when("/cadastros",{templateUrl:"global/st-api/cadastros/template-route/cadastros.html",controller:"cadastrosController"})})}(),function(){angular.module("stapi").factory("cadastrosUtil",function($rootScope,$filter,stUtil,$mdDialog){var _openCadastro=function(cadastro,callback){$mdDialog.show({animation:!0,templateUrl:"global/st-api/cadastros/template-module/detalheCadastro.html",
size:"lg",controller:function($scope,stService,stUtil){$scope.cadastro=cadastro,$scope.fechar=function(modal){modal.$dismiss("")},$scope.salvar=function(cadastro,modal){stService.save("opcao",cadastro).then(function(data){stUtil.showMessage("","Opção adicionada com sucesso!","info"),modal.$dismiss(""),callback(data.item)})}}})};return{openCadastro:_openCadastro}})}(),function(){function configUtil($mdDialog,stService,$rootScope,stUtil,$localStorage,$location){var _getConfig=function(callback){stService.getAll("config").then(function(data){$rootScope.config=data.itens[0],$localStorage.config=data.itens[0],callback($rootScope.config)})},_setConfig=function(key,value,callback){var config=$rootScope.config,confs=$rootScope.config.confs;confs[key]=value,config.confs=confs,stService.save("config",config).then(function(data){$rootScope.config=data.item,callback&&callback(data.item)})},_openConfig=function(tab,callback){$mdDialog.show({animation:!0,templateUrl:"global/st-api/app-config/template-module/config.html",size:"lg",controller:function($scope){$scope.activeTab=tab||0,$scope.modulos=[{nome:"Pessoas"},{nome:"Logística Reversa"},{nome:"Controle de Ponto"},{nome:"Estoque"},{nome:"Financeiro"},{nome:"Ferramentas"},{nome:"Relatorios"}],$scope.itensRelatorio=[{label:"Balanço",value:"balanco"},{label:"Lançamentos anteriores baixados",value:"lancamentos_anteriores_baixados"},{label:"Lucro por período (Mensal)",value:"lucro_periodo_mensal"},{label:"Produtos mais vendidos",value:"produtos_mais_vendidos"},{label:"Faturamento por produto",value:"faturamento_por_produto"},{label:"Despesas por categoria",value:"despesas_por_categoria"}],$scope.config=$rootScope.config,console.log("Config do rootScope: "),console.log($scope.config),$scope.config.id=1;var mds=$scope.modulos,mdsUser=[],itensRelatorio=[],itensRelatorioScope=$scope.itensRelatorio;$scope.config.confs||($scope.config.confs={}),$scope.config.confs.modulos&&(mdsUser=$scope.config.confs.modulos.split(",")),$scope.config.confs.itensRelatorio&&(itensRelatorio=$scope.config.confs.itensRelatorio.split(","));for(var i in mds)-1!=stUtil.buscaOb(mdsUser,mds[i].nome)&&(mds[i].selecionado=!0);for(var j in itensRelatorioScope)-1!=stUtil.buscaOb(itensRelatorio,itensRelatorioScope[j].value)&&(itensRelatorioScope[j].selecionado=!0);$scope.modulos=mds,$scope.itensRelatorio=itensRelatorioScope,$scope.salvar=function(){var conf=$scope.config,its=$scope.itensRelatorio,itensRelatorio="";for(var j in its)1==its[j].selecionado&&(itensRelatorio+=its[j].value+",");conf.confs.itensRelatorio=itensRelatorio;var mds="";for(var i in $scope.modulos)1==$scope.modulos[i].selecionado&&(mds+=$scope.modulos[i].nome+",");conf.confs.modulos=mds,stService.save("config",conf).then(function(data){stUtil.showMessage("","Salvo com sucesso!","info"),console.log("Config salvo: "),console.log(data.item),$rootScope.config=data.item})},$scope.fechar=function(ele){ele.$dismiss("cancel"),callback($scope.objeto)}}})};return{openConfig:_openConfig,getConfig:_getConfig,setConfig:_setConfig}}angular.module("stapi").factory("configUtil",configUtil)}(),function(){function buttonOpenConfig(configUtil){return{templateUrl:"global/st-api/st-config/html/button-config.html",scope:{activeTab:"=",label:"=",extraClass:"="},controller:function($scope){$scope.open=function(){configUtil.openConfig($scope.activeTab||0)}}}}angular.module("stapi").directive("buttonOpenConfig",buttonOpenConfig)}(),function(){function stPagination(anchorScroll){return{restrict:"AE",templateUrl:"global/st-api/st-pagination/html/stPagination.html",scope:{idElementToScroll:"@",querys:"="},controller:function($scope,$rootScope){$scope.pagina=0,$scope.max=$rootScope.config.confs.maxItensPage||7,$scope.setPagina=function(pagina){anchorScroll.scrollTo($scope.idElementToScroll||"anchor_cima"),$scope.pagina=pagina,$scope.$parent.getLikeMap&&$scope.$parent.getLikeMap($scope.querys||[""],$scope.pagina,$rootScope.config.confs.maxItensPage||7,"","id","DESC")}}}}angular.module("stapi").directive("stPagination",stPagination)}(),function(){function stInputChip(stUtil){return{restrict:"E",templateUrl:"global/st-api/st-string-check/html/stStringCheck.html",controllerAs:"ctrl",bindToController:!0,scope:{ngModel:"=",items:"<",titulo:"@"},controller:function($scope){var ctrl=this;ctrl.selected=ctrl.ngModel?ctrl.ngModel.split(","):[],$scope.$watch("ctrl.selected",function(value){ctrl.ngModel=value.join()},!0),ctrl.toggle=function(item,list){var idx=stUtil.buscaOb(list,item,"attr");idx>-1?list.splice(idx,1):list.push(item)},ctrl.exists=function(item,list){return stUtil.buscaOb(list,item,"attr")>-1},ctrl.isIndeterminate=function(){return 0!==ctrl.selected.length&&ctrl.selected.length!==ctrl.items.length},ctrl.isChecked=function(){return ctrl.selected.length===ctrl.items.length},ctrl.toggleAll=function(){if(ctrl.selected.length===ctrl.items.length)ctrl.selected=[];else if(0===ctrl.selected.length||ctrl.selected.length>0){var array=ctrl.items.slice(0),arrayInt=[];for(var i in array)arrayInt.push(array[i].attr);ctrl.selected=arrayInt}}}}}angular.module("stapi").directive("stStringCheck",stInputChip)}(),function(){function stInputChip(){return{restrict:"E",template:' <md-chips ng-model="ctrl.items"  placeholder="{{ctrl.placeholder}}"></md-chips>',controllerAs:"ctrl",bindToController:!0,scope:{ngModel:"=",placeholder:"@"},controller:function($scope){var ctrl=this;ctrl.items=ctrl.ngModel?ctrl.ngModel.split(","):[],$scope.$watch("ctrl.items",function(value){value&&(ctrl.ngModel=value.join())})}}}angular.module("stapi").directive("stStringChip",stInputChip)}(),function(){function stToolbar(){return{restrict:"E",transclude:!0,templateUrl:"global/st-api/st-layout/html/stToolbar.html"}}function stVerticalSpace(){return{restrict:"E",replace:!0,template:'<div class="row col-lg-12"><div style="margin: 15px;"></div></div>'}}function stPanel(){return{restrict:"E",transclude:!0,template:'<div class="panel"><div class="panel-body"></div></div>',link:function(scope,element,attrs,ctrl,transclude){transclude(scope,function(clone){element.children(0).children(0).append(clone)})}}}angular.module("stapi").directive("stVerticalSpace",stVerticalSpace).directive("stPanel",stPanel).directive("panel",stPanel).directive("stToolbar",stToolbar)}(),function(){function stFilterPagination(){return{templateUrl:"global/st-api/st-filter/html/stFilterPagination.html",restrict:"E",scope:{queryOptions:"=",getList:"=",totalItens:"=",itensInPage:"=",filtros:"<"},bindToController:!0,controllerAs:"vm",controller:"stFilterPaginationController"}}function stFilter(){return{templateUrl:"global/st-api/st-filter/html/stFilter.html",restrict:"E",scope:{filtros:"=",queryOptions:"=",getList:"="},bindToController:!0,controllerAs:"vm",controller:"stFilterController"}}function stFilterMap($filter,$rootScope){return{templateUrl:"global/st-api/st-filter/html/stFilterMap.html",restrict:"AE",scope:{filtros:"=",filterMapInstance:"=",querys:"=",extra:"="},controller:function($scope,stUtil){$scope.extra||($scope.extra=""),$scope.$watch("querys",function(value){$scope.aplicarFiltros(null,0,$rootScope.config.confs.maxItensPage||7,$scope.orderBy,$scope.orderType)}),$scope.filtros&&($scope.infoBusca=$scope.filtros[0]),$scope.dataHoje=$filter("date")(new Date,"dd/MM/yyyy"),$scope.pagina=0,$scope.max=$rootScope.config.confs.maxItensPage||7,$scope.qs=[],$scope.orderBy,$scope.ordem="DESC",$scope.objectFilter={},$scope.limparFiltros=function(){$scope.objectFilter={}},$scope.atualizar=function(){$scope.aplicarFiltros(null,0,$scope.max)},$scope.changeInfoBusca=function(info){$scope.infoBusca=info},$scope.buscar=function(info){stUtil.disableFocus();var objectFilter={};info&&(objectFilter[info.attr]=info.value),$scope.aplicarFiltros(objectFilter,0,$scope.max)},$scope.setPagina=function(pagina){$scope.pagina=pagina,$scope.$parent.getLikeMap($scope.qs,$scope.pagina,$scope.max,$scope.extra,$scope.orderBy,$scope.ordem)},$scope.aplicarFiltros=function(objectFilter,pagina,max,orderBy,ordem,interceptFilter){if($scope.pagina=0,objectFilter&&objectFilter.id&&objectFilter.id.length>0)return void $scope.$parent.getLikeMap(["id = "+objectFilter.id],$scope.pagina,max,$scope.extra,orderBy,ordem);var obs={};for(var key in objectFilter)obs[key]=objectFilter[key];$scope.qs=[];var query;for(var key in obs){if(query="","string"==typeof obs[key]&&obs[key].match(/\d{2}\/\d{2}\/\d{4}/)){var dataDe=obs[key]||"01/01/0000",dataAte=obs[key+"_ate"]||"01/01/3000";key=key.replace(/_ate/g,""),query=key+" between '"+stUtil.formatData(dataDe)+"' and '"+stUtil.formatData(dataAte)+"'",delete obs[key+"_ate"]}else if("string"==typeof obs[key]&&obs[key].match(/[\d]+\.[\d]+$/)){var de,ate;key.match(/[\w]+_ate/)?ate=obs[key]:de=obs[key],de=de||0,ate=ate||9e10,key=key.replace(/_ate/g,""),query=key+" between "+de+" and "+ate}else if(obs[key].toString().length>0){var valor=obs[key],operador="";"string"==typeof valor?(valor="'%"+valor+"%'",operador="like"):1==valor?(valor=1,operador="="):0==valor?(valor=0,operador="="):operador="=",query=key+" "+operador+" "+valor}query.length>0&&$scope.qs.push(query)}$scope.querys&&($scope.qs=$scope.qs.concat($scope.querys)),$scope.qs&&0!=$scope.qs.length||($scope.qs=[""]),$scope.$parent.getLikeMap&&$scope.$parent.getLikeMap($scope.qs,0,max,$scope.extra,$scope.orderBy,$scope.orderType)}}}}angular.module("stapi").directive("stFilterPagination",stFilterPagination).directive("stFilter",stFilter).directive("stFilterMap",stFilterMap)}(),function(){function stFilterPaginationController($scope,config,$anchorScroll,$location){var vm=this;vm.scope=$scope,vm.setPagina=function(pagina){$location.hash("top"),$anchorScroll(),vm.queryOptions.pagina=pagina,vm.getList(vm.queryOptions)}}function stFilterController($scope){function getQueryFromFilter(filtro){var queryValue=filtro.value,query="";if(filtro.value.length>0){filtro.operator=filtro.operator||"like";var operator=filtro.operator;"like"===operator&&(queryValue="'%"+queryValue+"%'"),query=filtro.attr+" "+operator+" "+queryValue+" "}return query}function init(){vm.filtroAtivo=vm.filtros[0]}var vm=this;vm.scope=$scope,vm.openMenuFiltros=function($mdMenu,ev){$mdMenu.open(ev)},vm.executarBusca=function(){var query=getQueryFromFilter(vm.filtroAtivo);vm.queryOptions.querys=[query],vm.queryOptions.pagina=0,vm.getList(vm.queryOptions)},vm.changeFiltroAtivo=function(filtro){vm.filtroAtivo=filtro},init()}angular.module("stapi").controller("stFilterController",stFilterController).controller("stFilterPaginationController",stFilterPaginationController)}(),function(){angular.module("stapi.stAutoComplete",["stapi"])}(),function(){function stAutoComplete(){return{restrict:"E",require:"ngModel, objectName",scope:{placeholder:"@",label:"@",listItemIcon:"@",idInput:"@",objectName:"@",getCompleteObject:"<",attr:"@",ngModel:"<",initialBusca:"@",fixProperties:"<",valueOnly:"<",resultadoBusca:"=",useCache:"<",autoShowBusca:"<"},templateUrl:"global/st-api/st-autocomplete/html/stAutoComplete.html",controller:"stAutoCompleteController",bindToController:!0,controllerAs:"$stAutoCompleteCtrl"}}angular.module("stapi").directive("stAutoComplete",stAutoComplete).directive("autoComplete",stAutoComplete)}(),function(){function stAutoCompleteController($scope,$element,stService,stUtil,$mdDialog,$timeout,cacheGet,genericUtil,$log,$mdMedia,$rootScope){function fecharDialog(){$mdDialog.hide()}function loadingIsVisible(){return ctrl.loading}function openBusca(parentElement){var useFullScreen=$mdMedia("sm")||$mdMedia("xs");$mdDialog.show({templateUrl:"global/st-api/st-autocomplete/html/buscaStAutoComplete.html",scope:$scope.$new(),controller:function($scope){void 0!=ctrl.initialBusca&&ctrl.buscarItem(ctrl.initialBusca)},parent:parentElement||angular.element(document.body),clickOutsideToClose:!1,multiple:!0,fullscreen:useFullScreen})}function buscarItem(valueattr){if(valueattr=valueattr||"",ctrl.useCache&&0!=ctrl.useCache){var itens=(new Date,cacheGet.get(ctrl.objectName.toLowerCase(),ctrl.attr,valueattr));itens=jlinq.from(itens).starts(ctrl.attr,valueattr).select();var its=[];for(var i in itens)its.push([itens[i].id,itens[i][ctrl.attr]]);ctrl.obs=its}else{var query=ctrl.attr+" like '%"+valueattr+"%'",qs=[];qs=qs.concat(stUtil.transformJSONToSqlComparators(ctrl.fixProperties)),qs.push(query);var objeto=ctrl.objectName;objeto=objeto[0].toUpperCase()+objeto.slice(1);var subattr="";ctrl.subattr&&(subattr=","+ctrl.subattr.attr);var columnsToQuery="";columnsToQuery=genericUtil.isGenericQuery(ctrl.attr)?"":"id,"+ctrl.attr+subattr||"*";var ops={qs:qs,columns:columnsToQuery,groupBy:"id",objeto:objeto};ctrl.loading=!0,stService.getProjecoes(ops).then(function(data){ctrl.loading=!1,ctrl.obs=data.itens})["catch"](function(){ctrl.loading=!1,ctrl.messageResult="Ocorreu um erro, tente novamente."})}}function getValueOfNivel(item,attr){return stUtil.getValueOfNivel(item,attr)}function cadastrarItem(value,allFilials){var attr=ctrl.attr,fix=ctrl.fixProperties;ctrl.loading=!0;var ob={};stUtil.setValueOfNivel(ob,attr,value);for(var k in fix)ob[k]=fix[k];ob.allFilials=allFilials;var query=attr+" = '"+stUtil.getValueOfNivel(ob,attr)+"'",qs=[];qs.push(query),qs=qs.concat(stUtil.transformJSONToSqlComparators(ctrl.fixProperties)),stService.getLikeMap(ctrl.objectName.toLowerCase(),qs,0,0,"").then(function(data){return data.itens.length>0?(stUtil.showMessage("","Já existe um registro com '"+stUtil.getValueOfNivel(ob,attr)+"' cadastrado no sistema","danger"),void(ctrl.loading=!1)):void stService.save(ctrl.objectName.toLowerCase(),ob).then(function(data){cacheGet.add(ctrl.objectName.toLowerCase(),[data.item]);var objeto=[data.item.id,stUtil.getValueOfNivel(data.item,attr)];ctrl.selecionarItem(objeto),value="",ctrl.loading=!1,stUtil.showMessage("","'"+stUtil.getValueOfNivel(ob,attr)+"' cadastrado com sucesso!","info"),$mdDialog.hide()})["catch"](function(){stUtil.showMessage("","Ocorreu um erro, verifique sua conexão com a internet.","danger"),ctrl.loading=!1,$mdDialog.hide()})})["catch"](function(){stUtil.showMessage("","Ocorreu um erro, verifique sua conexão com a internet.","danger"),ctrl.loading=!1})}function selecionarItem(item){if(ctrl.labelValue="",1==ctrl.getCompleteObject||genericUtil.isGenericQuery(ctrl.attr))ctrl.loading=!0,stService.getById(ctrl.objectName.toLowerCase(),item[0]||item.id).then(function(data){ctrl.loading=!1,data.item[ctrl.attr]=item[1]||stUtil.getValueOfNivel(item,ctrl.attr),setValueItem(data.item),$mdDialog.hide()})["catch"](function(){ctrl.loading=!1});else{var ob={};ob.id=item[0]||item.id,ob[ctrl.attr]=item[1]||stUtil.getValueOfNivel(item,ctrl.attr),setValueItem(ob),$mdDialog.hide()}}function setValueItem(objetoSele){var viewValue;1==ctrl.valueOnly?(viewValue=objetoSele[ctrl.attr],ctrl.showValue=objetoSele[ctrl.attr]):genericUtil.isGenericQuery(ctrl.attr)?(viewValue=objetoSele,ctrl.showValue=stUtil.getValueOfNivel(objetoSele,ctrl.attr)):(viewValue=objetoSele,ctrl.showValue=objetoSele[ctrl.attr]),ngModelCtrl.$setViewValue(viewValue),ctrl.attrValue=objetoSele[ctrl.attr],ctrl.obs=null}function init(){if(ctrl.ngModel){1!=ctrl.valueOnly?(setValueItem(ctrl.ngModel),ctrl.definidoNoInit=ctrl.ngModel):ctrl.showValue=ctrl.ngModel,ctrl.placeHolderBusca=ctrl.placeHolderBusca||"Digite um termo para buscar";1==ctrl.autoShowBusca&&ctrl.openBusca()}}var ngModelCtrl=$element.controller("ngModel"),ctrl=this;return ctrl.scope=$scope,ctrl.parent=$scope.$parent,ctrl.buscarItem=buscarItem,ctrl.openBusca=openBusca,ctrl.fecharDialog=fecharDialog,ctrl.getValueOfNivel=getValueOfNivel,ctrl.cadastrarItem=cadastrarItem,ctrl.selecionarItem=selecionarItem,ctrl.loadingIsVisible=loadingIsVisible,ctrl.objectName?void init():void $log.error("O parâmetro object-name deve ser informado")}angular.module("stapi").controller("stAutoCompleteController",stAutoCompleteController)}(),function(){function stModalContent(){return{templateUrl:"global/st-api/st-modal/html/modalContent.html",restrict:"E",transclude:!0,scope:{titulo:"=",iconeTitulo:"=",modalInstance:"=",labelCloseButton:"=",disableOkButton:"=",loadingOkAction:"=",okAction:"<",okActionLabel:"=",forceOkActionShowLabel:"=",okActionIcon:"=",cancelAction:"=",deleteAction:"=",item:"="},bindToController:!0,controllerAs:"vm",controller:function($scope,$timeout){var vm=this;vm.callToCancelAction=function(ctrl){vm.cancelAction?vm.cancelAction(ctrl):vm.modalInstance&&vm.modalInstance.$dismiss("cancel")}}}}function stDetalheContent(){return{templateUrl:"global/st-api/st-modal/html/detalheContent.html",transclude:!0,replace:!0,scope:{controller:"<"},bindToController:!0,controllerAs:"$stDetalheCtrl",controller:function($scope){var ctrl=this;ctrl.parent=ctrl.controller}}}function stModal($filter){return{templateUrl:"global/st-api/st-modal/html/stModal.html",restrict:"AE",transclude:!0,scope:{titulo:"@",icon:"@",idmodal:"@",size:"@",okIcon:"@",okLabel:"@"},link:function($scope,element,attrs){}}}angular.module("stapi").directive("stModalContent",stModalContent).directive("modalContent",stModalContent).directive("stDetalheContent",stDetalheContent).directive("stModal",stModal)}(),function(){function stSelectedItemsActions(){return{templateUrl:"global/st-api/st-selected-items-actions/html/stSelectedItemsActions.html",bindToController:!0,transclude:!0,scope:{selectedItems:"<",deleteFunction:"&"},controllerAs:"$stSelectedItemsActionsCtrl",controller:function($scope){var ctrl=this;ctrl.scope=$scope}}}angular.module("stapi").directive("stSelectedItemsActions",stSelectedItemsActions)}(),function(){function stNav(){return{restrict:"E",templateUrl:"global/st-api/st-nav/html/stNav.html",scope:{activeTab:"=",tabs:"="},controller:function($scope){$scope.activeTab||($scope.activeTab=0),$scope.alterarTab=function(tab){$scope.activeTab=tab}}}}angular.module("stapi").directive("stNav",stNav)}(),function(){function stTable(){return{restrict:"E",transclude:!0,scope:{columns:"<",items:"<",openDetail:"<",deleteFunction:"<",editColumn:"<",selectedItems:"="},templateUrl:"global/st-api/st-table/html/stTable.html",bindToController:!0,controllerAs:"$stTableCtrl",controller:function($scope,stUtil,$filter){function getColumnValue(ob,attr,filter){var value=stUtil.getValueOfNivel(ob,attr);if(filter&&filter.length>0){var parts=filter.split(":");value=$filter(parts[0])(value,parts[1])}return value}var ctrl=this;ctrl.scope=$scope,ctrl.getColumnValue=getColumnValue}}}angular.module("stapi").directive("stTable",stTable)}(),function(){function stDetalhe(){return{templateUrl:"global/st-api/st-detalhe/html/stDetalhe.html",bindToController:!0,replace:!0,transclude:!0,scope:{saveFunction:"&",cancelFunction:"&",deleteFunction:"&",item:"<",loading:"<",title:"@"},controllerAs:"$stDetalheCtrl",controller:function($scope){var ctrl=this;ctrl.scope=$scope}}}angular.module("stapi").directive("stDetalhe",stDetalhe)}(),function(){function stGridItem(){return{restrict:"E",transclude:!0,scope:{label:"@",icon:"@",deleteFunction:"&",openDetail:"&",item:"<"},templateUrl:"global/st-api/st-grid-item/html/stGridItem.html",bindToController:!0,controllerAs:"$stGridItemCtrl",controller:function(){}}}angular.module("stapi").directive("stGridItem",stGridItem)}(),function(){function stCardList(){return{restrict:"E",transclude:!0,scope:{ob:"=",hideButtons:"=",pivo:"=",editFunction:"=",deleteFunction:"=",index:"@",icon:"@"},templateUrl:"global/st-api/st-card-list/html/stCardList.html",bindToController:!0,controllerAs:"vm",controller:"stCardListController"}}angular.module("stapi").directive("stCardList",stCardList).directive("cardList",stCardList)}(),function(){function stCardList(stUtil){var vm=this;vm.ob&&vm.pivo&&(vm.labelPivo=stUtil.getValueOfNivel(vm.ob,vm.pivo))}angular.module("stapi").controller("stCardListController",stCardList)}(),function(){function testUserButton(stService,$mdDialog,stUtil){return{restrict:"AE",templateUrl:"global/st-api/st-test-user/html/testUserButton.html",link:function($rootScope,element,attrs){var _openDetalhe=function(){$rootScope.testIsOpen=!0;$mdDialog.show({animation:!0,templateUrl:"global/st-api/st-test-user/html/testUserDetalhe.html",size:"lg",controller:function($scope,$rootScope,$modalInstance,chronoService,$timeout){$scope.$on("modal.closing",function(){$rootScope.testIsOpen=!1});var _getProxTest=function(){$scope.carregandoTest=!0,stService.executeGet("testuser/prox-test").then(function(data){$rootScope.definition=data.item,null!=data.item&&$("#descricao-teste").html(data.item.descricao),$scope.carregandoTest=!1,stService.executeGet("/testuser/saldo-for-user").then(function(data){$rootScope.saldoTestes=data.item||0,stService.executeGet("/testuser/total-tests-for-user").then(function(data){$rootScope.quantTests=data.item||0})})})["catch"](function(){$scope.carregandoTest=!1,stUsilt.showMessage("","ocorreu um erro ao recuperar informações do teste, tente novamente"),$modalInstance.close()})};$scope.getProxTest=_getProxTest,$timeout(_getProxTest,300),$rootScope.voltar=function(){$modalInstance.close(),$rootScope.testIsOpen=!1},$rootScope.iniciarTeste=function(){$rootScope.iniTeste=(new Date).getTime(),$modalInstance.close(),$rootScope.executandoTeste=!0,$rootScope.testIsOpen=!1,chronoService.addTimer("myTimer",{interval:500}),chronoService.start(),stUtil.showMessage("","O teste foi iniciado!","info")},$rootScope.finalizarTeste=function(comentario,erroSistema){var teste={};teste.definition=$rootScope.definition,teste.comentario=comentario,teste.tempoGasto=(new Date).getTime()-$rootScope.iniTeste||0,teste.erroSistema=erroSistema,$rootScope.definition.queryVerification&&null!=$rootScope.definition.queryVerification?stService.executeGet("projecao/execute-query",{query:$rootScope.definition.queryVerification}).then(function(data){data.itens.length>0||1==erroSistema?_openDetalheFeedBack(teste):stUtil.showMessage("","Você não executou o teste corretamente, tente novamente ou descreva o erro nos","danger")}):_openDetalheFeedBack(teste)};var _openDetalheFeedBack=function(test){$mdDialog.show({animation:!0,templateUrl:"global/st-api/st-test-user/html/testeUserResposta.html",size:"lg",controller:function($scope,$modalInstance){$scope.test=test,$scope.salvar=function(){return $scope.test.nivelDificuldadeFromUser?void stService.executePost("testuser/add/",$scope.test).then(function(){stUtil.showMessage("","Teste executado com sucesso!","info"),$modalInstance.close(),$rootScope.executandoTeste=!1,$rootScope.testIsOpen=!1,_getProxTest()}):void stUtil.showMessage("","Escolha uma opção","danger")}}})}}})};element.bind("click",function(){_openDetalhe()})}}}angular.module("stapi").directive("testUserButton",testUserButton)}(),function(){angular.module("stapi").config(function($routeProvider,$httpProvider){$routeProvider.when("/testdefinition",{templateUrl:"global/st-api/st-test-user/html/testDefinition.html",controller:function($scope,stService,stUtil,$mdDialog){$scope.openDetalhe=function(definition){$mdDialog.show({animation:!0,templateUrl:"global/st-api/st-test-user/html/detalheTestDefinition.html",size:"lg",controller:function($scope,$modalInstance){$scope.definition=definition||{},$scope.salvar=function(){stService.executePost("testdefinition/add/",$scope.definition).then(function(){$modalInstance.close()})}}})}}}),$routeProvider.when("/teste",{templateUrl:"global/st-api/st-test-user/html/test.html"})})}(),function(){function tutorialUtil($rootScope,$filter,stUtil,$mdDialog){var _openDetalheTutorial=function(tutorialItem){$mdDialog.show({animation:!0,templateUrl:"global/st-api/st-tutorial/template-module/detalheTutorial.html",size:"lg",controllerAs:"vm",bindToController:!0,controller:function($scope,deviceDetector){var vm=this;vm.tutorial=tutorialItem,1==deviceDetector.isMobile()?vm.linkTutorial=tutorialItem.linkMobile:vm.linkTutorial=tutorialItem.linkDesktop;var youtubePlayer;vm.playerVars={modestbranding:1,rel:0,start:30,end:39},$scope.$on("youtube.player.ready",function($event,player){youtubePlayer=player,youtubePlayer.playVideo()})}})};return{openDetalheTutorial:_openDetalheTutorial}}angular.module("stapi").factory("tutorialUtil",tutorialUtil)}(),function(){function buttonTutorial($mdDialog,tutorialUtil){return{restrict:"AE",link:function(scope,element,attrs){element.bind("click",function(){$mdDialog.show({animation:!0,templateUrl:"global/st-api/st-tutorial/html/tutorialList.html",size:"lg",controllerAs:"vm",bindToController:!0,controller:function($scope){var vm=this;vm.tutoriais=[{titulo:"Vendas",descricao:"Como realizar uma venda, listagem de vendas",linkMobile:"https://www.youtube.com/watch?v=sOdiWXFF9Ms",linkDesktop:"https://www.youtube.com/watch?v=93RTB0PXAU0&feature=youtu.be"},{titulo:"Estoque",descricao:"Cadastro e listagem de produtos",linkMobile:"",linkDesktop:""}],vm.openTutorial=function(item){tutorialUtil.openDetalheTutorial(item)}}})})}}}angular.module("stapi").directive("buttonTutorial",buttonTutorial)}();